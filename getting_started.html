

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Getting Started &mdash; Spack 0.23.1 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=5f00b823" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="_static/graphviz.css?v=4ae1632d" />
      <link rel="stylesheet" type="text/css" href="_static/sphinx-design.min.css?v=95c83b7e" />

  
    <link rel="shortcut icon" href="_static/favicon.ico"/>
      <script src="_static/jquery.js?v=5d32c60e"></script>
      <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="_static/documentation_options.js?v=832b3b9f"></script>
      <script src="_static/doctools.js?v=9bcbadda"></script>
      <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
      <script src="_static/design-tabs.js?v=f930bc37"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Basic Usage" href="basic_usage.html" />
    <link rel="prev" title="Feature Overview" href="features.html" /> 
  <!-- Google tag (gtag.js) -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-S0PQ7WV75K"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-S0PQ7WV75K');
  </script>

</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html">
            
              <img src="_static/spack-logo-white-text.svg" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Basics</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="features.html">Feature Overview</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Getting Started</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#system-prerequisites">System Prerequisites</a></li>
<li class="toctree-l2"><a class="reference internal" href="#installation">Installation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#shell-support">Shell support</a></li>
<li class="toctree-l3"><a class="reference internal" href="#bootstrapping-clingo">Bootstrapping clingo</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#the-bootstrap-store">The Bootstrap Store</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#check-installation">Check Installation</a></li>
<li class="toctree-l3"><a class="reference internal" href="#clean-environment">Clean Environment</a></li>
<li class="toctree-l3"><a class="reference internal" href="#optional-alternate-prefix">Optional: Alternate Prefix</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#compiler-configuration">Compiler configuration</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#spack-compilers"><code class="docutils literal notranslate"><span class="pre">spack</span> <span class="pre">compilers</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#spack-compiler-add"><code class="docutils literal notranslate"><span class="pre">spack</span> <span class="pre">compiler</span> <span class="pre">add</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#spack-compiler-find"><code class="docutils literal notranslate"><span class="pre">spack</span> <span class="pre">compiler</span> <span class="pre">find</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#spack-compiler-info"><code class="docutils literal notranslate"><span class="pre">spack</span> <span class="pre">compiler</span> <span class="pre">info</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#manual-compiler-configuration">Manual compiler configuration</a></li>
<li class="toctree-l3"><a class="reference internal" href="#build-your-own-compiler">Build Your Own Compiler</a></li>
<li class="toctree-l3"><a class="reference internal" href="#compilers-requiring-modules">Compilers Requiring Modules</a></li>
<li class="toctree-l3"><a class="reference internal" href="#licensed-compilers">Licensed Compilers</a></li>
<li class="toctree-l3"><a class="reference internal" href="#mixed-toolchains">Mixed Toolchains</a></li>
<li class="toctree-l3"><a class="reference internal" href="#compiler-verification">Compiler Verification</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#vendor-specific-compiler-configuration">Vendor-Specific Compiler Configuration</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#intel-compilers">Intel Compilers</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#configuration-with-modules">Configuration with Modules</a></li>
<li class="toctree-l4"><a class="reference internal" href="#command-line-configuration">Command Line Configuration</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#pgi">PGI</a></li>
<li class="toctree-l3"><a class="reference internal" href="#nag">NAG</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#system-packages">System Packages</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#mpi">MPI</a></li>
<li class="toctree-l3"><a class="reference internal" href="#openssl">OpenSSL</a></li>
<li class="toctree-l3"><a class="reference internal" href="#blas-lapack">BLAS / LAPACK</a></li>
<li class="toctree-l3"><a class="reference internal" href="#git">Git</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#utilities-configuration">Utilities Configuration</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#core-spack-utilities">Core Spack Utilities</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#curl-git-mercurial-etc">cURL, git, Mercurial, etc.</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#package-utilities">Package Utilities</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#binutils">binutils</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#gpg-signing">GPG Signing</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#spack-gpg"><code class="docutils literal notranslate"><span class="pre">spack</span> <span class="pre">gpg</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#spack-gpg-init"><code class="docutils literal notranslate"><span class="pre">spack</span> <span class="pre">gpg</span> <span class="pre">init</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#trusting-keys">Trusting keys</a></li>
<li class="toctree-l3"><a class="reference internal" href="#creating-keys">Creating keys</a></li>
<li class="toctree-l3"><a class="reference internal" href="#listing-keys">Listing keys</a></li>
<li class="toctree-l3"><a class="reference internal" href="#signing-and-verifying-packages">Signing and Verifying Packages</a></li>
<li class="toctree-l3"><a class="reference internal" href="#exporting-keys">Exporting Keys</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#spack-on-windows">Spack On Windows</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#step-1-install-prerequisites">Step 1: Install prerequisites</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#microsoft-visual-studio">Microsoft Visual Studio</a></li>
<li class="toctree-l4"><a class="reference internal" href="#intel-fortran">Intel Fortran</a></li>
<li class="toctree-l4"><a class="reference internal" href="#python">Python</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id7">Git</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#step-2-install-and-setup-spack">Step 2: Install and setup Spack</a></li>
<li class="toctree-l3"><a class="reference internal" href="#step-3-run-and-configure-spack">Step 3: Run and configure Spack</a></li>
<li class="toctree-l3"><a class="reference internal" href="#step-4-use-spack">Step 4: Use Spack</a></li>
<li class="toctree-l3"><a class="reference internal" href="#for-developers">For developers</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="basic_usage.html">Basic Usage</a></li>
<li class="toctree-l1"><a class="reference internal" href="replace_conda_homebrew.html">Spack for Homebrew/Conda Users</a></li>
<li class="toctree-l1"><a class="reference internal" href="frequently_asked_questions.html">Frequently Asked Questions</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Links</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://spack-tutorial.readthedocs.io">Tutorial (spack-tutorial.rtfd.io)</a></li>
<li class="toctree-l1"><a class="reference external" href="https://packages.spack.io">Packages (packages.spack.io)</a></li>
<li class="toctree-l1"><a class="reference external" href="https://cache.spack.io">Binaries (binaries.spack.io)</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="configuration.html">Configuration Files</a></li>
<li class="toctree-l1"><a class="reference internal" href="config_yaml.html">Spack Settings (config.yaml)</a></li>
<li class="toctree-l1"><a class="reference internal" href="packages_yaml.html">Package Settings (packages.yaml)</a></li>
<li class="toctree-l1"><a class="reference internal" href="build_settings.html">Concretization Settings (concretizer.yaml)</a></li>
<li class="toctree-l1"><a class="reference internal" href="environments.html">Environments (spack.yaml, spack.lock)</a></li>
<li class="toctree-l1"><a class="reference internal" href="containers.html">Container Images</a></li>
<li class="toctree-l1"><a class="reference internal" href="mirrors.html">Mirrors (mirrors.yaml)</a></li>
<li class="toctree-l1"><a class="reference internal" href="module_file_support.html">Modules (modules.yaml)</a></li>
<li class="toctree-l1"><a class="reference internal" href="repositories.html">Package Repositories (repos.yaml)</a></li>
<li class="toctree-l1"><a class="reference internal" href="binary_caches.html">Build Caches</a></li>
<li class="toctree-l1"><a class="reference internal" href="bootstrapping.html">Bootstrapping</a></li>
<li class="toctree-l1"><a class="reference internal" href="command_index.html">Command Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="chain.html">Chaining Spack Installations (upstreams.yaml)</a></li>
<li class="toctree-l1"><a class="reference internal" href="extensions.html">Custom Extensions</a></li>
<li class="toctree-l1"><a class="reference internal" href="pipelines.html">CI Pipelines</a></li>
<li class="toctree-l1"><a class="reference internal" href="signing.html">Spack Package Signing</a></li>
<li class="toctree-l1"><a class="reference internal" href="gpu_configuration.html">Using External GPU Support</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Contributing</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="contribution_guide.html">Contribution Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="packaging_guide.html">Packaging Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="build_systems.html">Build Systems</a></li>
<li class="toctree-l1"><a class="reference internal" href="developer_guide.html">Developer Guide</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API Docs</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="spack.html">Spack API Docs</a></li>
<li class="toctree-l1"><a class="reference internal" href="llnl.html">LLNL API Docs</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Spack</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Getting Started</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/getting_started.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="getting-started">
<span id="id1"></span><h1>Getting Started<a class="headerlink" href="#getting-started" title="Link to this heading"></a></h1>
<section id="system-prerequisites">
<h2>System Prerequisites<a class="headerlink" href="#system-prerequisites" title="Link to this heading"></a></h2>
<p>Spack has the following minimum system requirements, which are assumed to
be present on the machine where Spack is run:</p>
<table class="docutils align-default" id="id8">
<caption><span class="caption-text">System prerequisites for Spack</span><a class="headerlink" href="#id8" title="Link to this table"></a></caption>
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head"><p>Supported Versions</p></th>
<th class="head"><p>Notes</p></th>
<th class="head"><p>Requirement Reason</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Python</p></td>
<td><p>3.6–3.12</p></td>
<td></td>
<td><p>Interpreter for Spack</p></td>
</tr>
<tr class="row-odd"><td><p>C/C++ Compilers</p></td>
<td></td>
<td></td>
<td><p>Building software</p></td>
</tr>
<tr class="row-even"><td><p>patch</p></td>
<td></td>
<td></td>
<td><p>Build software</p></td>
</tr>
<tr class="row-odd"><td><p>tar</p></td>
<td></td>
<td></td>
<td><p>Extract/create archives</p></td>
</tr>
<tr class="row-even"><td><p>gzip</p></td>
<td></td>
<td></td>
<td><p>Compress/Decompress archives</p></td>
</tr>
<tr class="row-odd"><td><p>unzip</p></td>
<td></td>
<td></td>
<td><p>Compress/Decompress archives</p></td>
</tr>
<tr class="row-even"><td><p>bzip2</p></td>
<td></td>
<td></td>
<td><p>Compress/Decompress archives</p></td>
</tr>
<tr class="row-odd"><td><p>xz</p></td>
<td></td>
<td></td>
<td><p>Compress/Decompress archives</p></td>
</tr>
<tr class="row-even"><td><p>zstd</p></td>
<td></td>
<td><p>Optional</p></td>
<td><p>Compress/Decompress archives</p></td>
</tr>
<tr class="row-odd"><td><p>file</p></td>
<td></td>
<td></td>
<td><p>Create/Use Buildcaches</p></td>
</tr>
<tr class="row-even"><td><p>lsb-release</p></td>
<td></td>
<td></td>
<td><p>Linux: identify operating system version</p></td>
</tr>
<tr class="row-odd"><td><p>gnupg2</p></td>
<td></td>
<td></td>
<td><p>Sign/Verify Buildcaches</p></td>
</tr>
<tr class="row-even"><td><p>git</p></td>
<td></td>
<td></td>
<td><p>Manage Software Repositories</p></td>
</tr>
<tr class="row-odd"><td><p>svn</p></td>
<td></td>
<td><p>Optional</p></td>
<td><p>Manage Software Repositories</p></td>
</tr>
<tr class="row-even"><td><p>hg</p></td>
<td></td>
<td><p>Optional</p></td>
<td><p>Manage Software Repositories</p></td>
</tr>
<tr class="row-odd"><td><p>Python header files</p></td>
<td></td>
<td><p>Optional (e.g. <code class="docutils literal notranslate"><span class="pre">python3-dev</span></code> on Debian)</p></td>
<td><p>Bootstrapping from sources</p></td>
</tr>
</tbody>
</table>
<p>These requirements can be easily installed on most modern Linux systems;
on macOS, the Command Line Tools package is required, and a full XCode suite
may be necessary for some packages such as Qt and apple-gl. Spack is designed
to run on HPC platforms like Cray.  Not all packages should be expected
to work on all platforms.</p>
<p>A build matrix showing which packages are working on which systems is shown below.</p>
<div class="sd-tab-set docutils">
<input checked="checked" id="sd-tab-item-0" name="sd-tab-set-0" type="radio">
<label class="sd-tab-label" for="sd-tab-item-0">
Debian/Ubuntu</label><div class="sd-tab-content docutils">
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">apt update</span>
<span class="go">apt install bzip2 ca-certificates file g++ gcc gfortran git gzip lsb-release patch python3 tar unzip xz-utils zstd</span>
</pre></div>
</div>
</div>
<input id="sd-tab-item-1" name="sd-tab-set-0" type="radio">
<label class="sd-tab-label" for="sd-tab-item-1">
RHEL</label><div class="sd-tab-content docutils">
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">dnf install epel-release</span>
<span class="go">dnf group install &quot;Development Tools&quot;</span>
<span class="go">dnf install gcc-gfortran redhat-lsb-core python3 unzip</span>
</pre></div>
</div>
</div>
<input id="sd-tab-item-2" name="sd-tab-set-0" type="radio">
<label class="sd-tab-label" for="sd-tab-item-2">
macOS Brew</label><div class="sd-tab-content docutils">
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">brew update</span>
<span class="go">brew install gcc git zip</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="installation">
<h2>Installation<a class="headerlink" href="#installation" title="Link to this heading"></a></h2>
<p>Getting Spack is easy.  You can clone it from the <a class="reference external" href="https://github.com/spack/spack">github repository</a> using this command:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>git<span class="w"> </span>clone<span class="w"> </span>-c<span class="w"> </span>feature.manyFiles<span class="o">=</span><span class="nb">true</span><span class="w"> </span>--depth<span class="o">=</span><span class="m">2</span><span class="w"> </span>https://github.com/spack/spack.git
</pre></div>
</div>
<p>This will create a directory called <code class="docutils literal notranslate"><span class="pre">spack</span></code>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><code class="docutils literal notranslate"><span class="pre">-c</span> <span class="pre">feature.manyFiles=true</span></code> improves git’s performance on repositories with 1,000+ files.</p>
<p><code class="docutils literal notranslate"><span class="pre">--depth=2</span></code> prunes the git history to reduce the size of the Spack installation.</p>
</div>
<section id="shell-support">
<span id="id2"></span><h3>Shell support<a class="headerlink" href="#shell-support" title="Link to this heading"></a></h3>
<p>Once you have cloned Spack, we recommend sourcing the appropriate script
for your shell:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp"># </span>For<span class="w"> </span>bash/zsh/sh
<span class="gp">$ </span>.<span class="w"> </span>spack/share/spack/setup-env.sh

<span class="gp"># </span>For<span class="w"> </span>tcsh/csh
<span class="gp">$ </span><span class="nb">source</span><span class="w"> </span>spack/share/spack/setup-env.csh

<span class="gp"># </span>For<span class="w"> </span>fish
<span class="gp">$ </span>.<span class="w"> </span>spack/share/spack/setup-env.fish
</pre></div>
</div>
<p>That’s it! You’re ready to use Spack.</p>
<p>Sourcing these files will put the <code class="docutils literal notranslate"><span class="pre">spack</span></code> command in your <code class="docutils literal notranslate"><span class="pre">PATH</span></code>, set
up your <code class="docutils literal notranslate"><span class="pre">MODULEPATH</span></code> to use Spack’s packages, and add other useful
shell integration for <a class="reference internal" href="packaging_guide.html#packaging-shell-support"><span class="std std-ref">certain commands</span></a>,
<a class="reference internal" href="environments.html#environments"><span class="std std-ref">environments</span></a>, and <a class="reference internal" href="module_file_support.html#modules"><span class="std std-ref">modules</span></a>. For
<code class="docutils literal notranslate"><span class="pre">bash</span></code> and <code class="docutils literal notranslate"><span class="pre">zsh</span></code>, it also sets up tab completion.</p>
<p>In order to know which directory to add to your <code class="docutils literal notranslate"><span class="pre">MODULEPATH</span></code>, these scripts
query the <code class="docutils literal notranslate"><span class="pre">spack</span></code> command. On shared filesystems, this can be a bit slow,
especially if you log in frequently. If you don’t use modules, or want to set
<code class="docutils literal notranslate"><span class="pre">MODULEPATH</span></code> manually instead, you can set the <code class="docutils literal notranslate"><span class="pre">SPACK_SKIP_MODULES</span></code>
environment variable to skip this step and speed up sourcing the file.</p>
<p>If you do not want to use Spack’s shell support, you can always just run
the <code class="docutils literal notranslate"><span class="pre">spack</span></code> command directly from <code class="docutils literal notranslate"><span class="pre">spack/bin/spack</span></code>.</p>
<p>When the <code class="docutils literal notranslate"><span class="pre">spack</span></code> command is executed it searches for an appropriate
Python interpreter to use, which can be explicitly overridden by setting
the <code class="docutils literal notranslate"><span class="pre">SPACK_PYTHON</span></code> environment variable.  When sourcing the appropriate shell
setup script, <code class="docutils literal notranslate"><span class="pre">SPACK_PYTHON</span></code> will be set to the interpreter found at
sourcing time, ensuring future invocations of the <code class="docutils literal notranslate"><span class="pre">spack</span></code> command will
continue to use the same consistent python version regardless of changes in
the environment.</p>
</section>
<section id="bootstrapping-clingo">
<h3>Bootstrapping clingo<a class="headerlink" href="#bootstrapping-clingo" title="Link to this heading"></a></h3>
<p>Spack uses <code class="docutils literal notranslate"><span class="pre">clingo</span></code> under the hood to resolve optimal versions and variants of
dependencies when installing a package. Since <code class="docutils literal notranslate"><span class="pre">clingo</span></code> itself is a binary,
Spack has to install it on initial use, which is called bootstrapping.</p>
<p>Spack provides two ways of bootstrapping <code class="docutils literal notranslate"><span class="pre">clingo</span></code>: from pre-built binaries
(default), or from sources. The fastest way to get started is to bootstrap from
pre-built binaries.</p>
<p>The first time you concretize a spec, Spack will bootstrap automatically:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>spack<span class="w"> </span>spec<span class="w"> </span>zlib
<span class="go">==&gt; Bootstrapping clingo from pre-built binaries</span>
<span class="go">==&gt; Fetching https://mirror.spack.io/bootstrap/github-actions/v0.4/build_cache/linux-centos7-x86_64-gcc-10.2.1-clingo-bootstrap-spack-ba5ijauisd3uuixtmactc36vps7yfsrl.spec.json</span>
<span class="go">==&gt; Fetching https://mirror.spack.io/bootstrap/github-actions/v0.4/build_cache/linux-centos7-x86_64/gcc-10.2.1/clingo-bootstrap-spack/linux-centos7-x86_64-gcc-10.2.1-clingo-bootstrap-spack-ba5ijauisd3uuixtmactc36vps7yfsrl.spack</span>
<span class="go">==&gt; Installing &quot;clingo-bootstrap@spack%gcc@10.2.1~docs~ipo+python+static_libstdcpp build_type=Release arch=linux-centos7-x86_64&quot; from a buildcache</span>
<span class="go">==&gt; Bootstrapping patchelf from pre-built binaries</span>
<span class="go">==&gt; Fetching https://mirror.spack.io/bootstrap/github-actions/v0.4/build_cache/linux-centos7-x86_64-gcc-10.2.1-patchelf-0.16.1-p72zyan5wrzuabtmzq7isa5mzyh6ahdp.spec.json</span>
<span class="go">==&gt; Fetching https://mirror.spack.io/bootstrap/github-actions/v0.4/build_cache/linux-centos7-x86_64/gcc-10.2.1/patchelf-0.16.1/linux-centos7-x86_64-gcc-10.2.1-patchelf-0.16.1-p72zyan5wrzuabtmzq7isa5mzyh6ahdp.spack</span>
<span class="go">==&gt; Installing &quot;patchelf@0.16.1%gcc@10.2.1 ldflags=&quot;-static-libstdc++ -static-libgcc&quot;  build_system=autotools arch=linux-centos7-x86_64&quot; from a buildcache</span>
<span class="go">Input spec</span>
<span class="go">--------------------------------</span>
<span class="go">zlib</span>

<span class="go">Concretized</span>
<span class="go">--------------------------------</span>
<span class="gp">zlib@1.2.13%</span>gcc@9.4.0+optimize+pic+shared<span class="w"> </span><span class="nv">build_system</span><span class="o">=</span>makefile<span class="w"> </span><span class="nv">arch</span><span class="o">=</span>linux-ubuntu20.04-icelake
</pre></div>
</div>
<p>The default bootstrap behavior is to use pre-built binaries. You can verify the
active bootstrap repositories with:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>$ spack bootstrap list
Name: github-actions-v0.6 ENABLED

  Type: buildcache

  Info: 
    url: oci://ghcr.io/spack/bootstrap-buildcache-v1
    homepage: https://github.com/spack/spack-bootstrap-mirrors
    releases: https://github.com/spack/spack-bootstrap-mirrors/releases

  Description: 
    Buildcache generated from a public workflow using GitHub Actions hosted on GitHub Packages.
    The sha256 checksum of binaries is checked before installation.
    

Name: github-actions-v0.5 ENABLED

  Type: buildcache

  Info: 
    url: https://mirror.spack.io/bootstrap/github-actions/v0.5
    homepage: https://github.com/spack/spack-bootstrap-mirrors
    releases: https://github.com/spack/spack-bootstrap-mirrors/releases

  Description: 
    Buildcache generated from a public workflow using Github Actions.
    The sha256 checksum of binaries is checked before installation.
    

Name: spack-install ENABLED

  Type: install

  Info: 
    url: https://mirror.spack.io

  Description: 
    Specs built from sources downloaded from the Spack public mirror.
</pre></div>
</div>
<p>If for security concerns you cannot bootstrap <code class="docutils literal notranslate"><span class="pre">clingo</span></code> from pre-built
binaries, you have to disable fetching the binaries we generated with Github Actions.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>spack<span class="w"> </span>bootstrap<span class="w"> </span>disable<span class="w"> </span>github-actions-v0.6
<span class="go">==&gt; &quot;github-actions-v0.6&quot; is now disabled and will not be used for bootstrapping</span>
<span class="gp">$ </span>spack<span class="w"> </span>bootstrap<span class="w"> </span>disable<span class="w"> </span>github-actions-v0.5
<span class="go">==&gt; &quot;github-actions-v0.5&quot; is now disabled and will not be used for bootstrapping</span>
</pre></div>
</div>
<p>You can verify that the new settings are effective with <code class="docutils literal notranslate"><span class="pre">spack</span> <span class="pre">bootstrap</span> <span class="pre">list</span></code>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>When bootstrapping from sources, Spack requires a full install of Python
including header files (e.g. <code class="docutils literal notranslate"><span class="pre">python3-dev</span></code> on Debian), and a compiler
with support for C++14 (GCC on Linux, Apple Clang on macOS) and static C++
standard libraries on Linux.</p>
</div>
<p>Spack will build the required software on the first request to concretize a spec:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>spack<span class="w"> </span>spec<span class="w"> </span>zlib
<span class="go">[+] /usr (external bison-3.0.4-wu5pgjchxzemk5ya2l3ddqug2d7jv6eb)</span>
<span class="go">[+] /usr (external cmake-3.19.4-a4kmcfzxxy45mzku4ipmj5kdiiz5a57b)</span>
<span class="go">[+] /usr (external python-3.6.9-x4fou4iqqlh5ydwddx3pvfcwznfrqztv)</span>
<span class="go">==&gt; Installing re2c-1.2.1-e3x6nxtk3ahgd63ykgy44mpuva6jhtdt</span>
<span class="go">[ ... ]</span>
<span class="gp">zlib@1.2.11%</span>gcc@10.1.0+optimize+pic+shared<span class="w"> </span><span class="nv">arch</span><span class="o">=</span>linux-ubuntu18.04-broadwell
</pre></div>
</div>
<section id="the-bootstrap-store">
<h4>The Bootstrap Store<a class="headerlink" href="#the-bootstrap-store" title="Link to this heading"></a></h4>
<p>All the tools Spack needs for its own functioning are installed in a separate store, which lives
under the <code class="docutils literal notranslate"><span class="pre">${HOME}/.spack</span></code> directory. The software installed there can be queried with:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>spack<span class="w"> </span>-b<span class="w"> </span>find
<span class="go">-- linux-ubuntu18.04-x86_64 / gcc@10.1.0 ------------------------</span>
<span class="go">clingo-bootstrap@spack  python@3.6.9  re2c@1.2.1</span>
</pre></div>
</div>
<p>In case it’s needed the bootstrap store can also be cleaned with:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>spack<span class="w"> </span>clean<span class="w"> </span>-b
<span class="go">==&gt; Removing bootstrapped software and configuration in &quot;/home/spack/.spack/bootstrap&quot;</span>
</pre></div>
</div>
</section>
</section>
<section id="check-installation">
<h3>Check Installation<a class="headerlink" href="#check-installation" title="Link to this heading"></a></h3>
<p>With Spack installed, you should be able to run some basic Spack
commands.  For example:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>$ spack spec netcdf-c
 -   netcdf-c@4.9.2%gcc@14.2.0+blosc~byterange~dap~fsync~hdf4~jna~logging+mpi~nczarr_zip+optimize~parallel-netcdf+pic+shared+szip+zstd build_system=autotools patches=0161eb8 arch=linux-ubuntu24.04-zen2
 -       ^bzip2@1.0.8%gcc@14.2.0~debug~pic+shared build_system=generic arch=linux-ubuntu24.04-zen2
 -           ^diffutils@3.10%gcc@14.2.0 build_system=autotools arch=linux-ubuntu24.04-zen2
 -               ^libiconv@1.17%gcc@14.2.0 build_system=autotools libs=shared,static arch=linux-ubuntu24.04-zen2
 -       ^c-blosc@1.21.5%gcc@14.2.0+avx2~ipo build_system=cmake build_type=Release generator=make arch=linux-ubuntu24.04-zen2
 -           ^cmake@3.30.5%gcc@14.2.0~doc+ncurses+ownlibs~qtgui build_system=generic build_type=Release patches=dbc3892 arch=linux-ubuntu24.04-zen2
 -               ^curl@8.10.1%gcc@14.2.0~gssapi~ldap~libidn2~librtmp~libssh~libssh2+nghttp2 build_system=autotools libs=shared,static tls=openssl arch=linux-ubuntu24.04-zen2
 -                   ^nghttp2@1.63.0%gcc@14.2.0 build_system=autotools arch=linux-ubuntu24.04-zen2
 -               ^ncurses@6.5%gcc@14.2.0~symlinks+termlib abi=none build_system=autotools patches=7a351bc arch=linux-ubuntu24.04-zen2
 -           ^lz4@1.10.0%gcc@14.2.0+pic build_system=makefile libs=shared,static arch=linux-ubuntu24.04-zen2
 -           ^snappy@1.2.1%gcc@14.2.0~ipo+pic+shared build_system=cmake build_type=Release generator=make arch=linux-ubuntu24.04-zen2
 -       ^gcc-runtime@14.2.0%gcc@14.2.0 build_system=generic arch=linux-ubuntu24.04-zen2
[e]      ^glibc@2.39%gcc@14.2.0 build_system=autotools arch=linux-ubuntu24.04-zen2
 -       ^gmake@4.4.1%gcc@14.2.0~guile build_system=generic arch=linux-ubuntu24.04-zen2
 -       ^hdf5@1.14.5%gcc@14.2.0~cxx~fortran+hl~ipo~java~map+mpi+shared~subfiling~szip~threadsafe+tools api=default build_system=cmake build_type=Release generator=make arch=linux-ubuntu24.04-zen2
 -           ^pkgconf@2.2.0%gcc@14.2.0 build_system=autotools arch=linux-ubuntu24.04-zen2
 -       ^libaec@1.0.6%gcc@14.2.0~ipo+shared build_system=cmake build_type=Release generator=make arch=linux-ubuntu24.04-zen2
 -       ^openmpi@5.0.5%gcc@14.2.0+atomics~cuda~debug~gpfs~internal-hwloc~internal-libevent~internal-pmix~java~lustre~memchecker~openshmem~romio+rsh~static~two_level_namespace+vt+wrapper-rpath build_system=autotools fabrics=none romio-filesystem=none schedulers=none arch=linux-ubuntu24.04-zen2
 -           ^autoconf@2.72%gcc@14.2.0 build_system=autotools arch=linux-ubuntu24.04-zen2
 -               ^m4@1.4.19%gcc@14.2.0+sigsegv build_system=autotools patches=9dc5fbd,bfdffa7 arch=linux-ubuntu24.04-zen2
 -                   ^libsigsegv@2.14%gcc@14.2.0 build_system=autotools arch=linux-ubuntu24.04-zen2
 -           ^automake@1.16.5%gcc@14.2.0 build_system=autotools arch=linux-ubuntu24.04-zen2
 -           ^hwloc@2.11.1%gcc@14.2.0~cairo~cuda~gl~libudev+libxml2~nvml~oneapi-level-zero~opencl+pci~rocm build_system=autotools libs=shared,static arch=linux-ubuntu24.04-zen2
 -               ^libpciaccess@0.17%gcc@14.2.0 build_system=autotools arch=linux-ubuntu24.04-zen2
 -                   ^util-macros@1.20.1%gcc@14.2.0 build_system=autotools arch=linux-ubuntu24.04-zen2
 -               ^libxml2@2.13.4%gcc@14.2.0+pic~python+shared build_system=autotools arch=linux-ubuntu24.04-zen2
 -                   ^xz@5.4.6%gcc@14.2.0~pic build_system=autotools libs=shared,static arch=linux-ubuntu24.04-zen2
 -           ^libevent@2.1.12%gcc@14.2.0+openssl build_system=autotools arch=linux-ubuntu24.04-zen2
 -               ^openssl@3.4.0%gcc@14.2.0~docs+shared build_system=generic certs=mozilla arch=linux-ubuntu24.04-zen2
 -                   ^ca-certificates-mozilla@2023-05-30%gcc@14.2.0 build_system=generic arch=linux-ubuntu24.04-zen2
 -           ^libtool@2.4.7%gcc@14.2.0 build_system=autotools arch=linux-ubuntu24.04-zen2
 -               ^findutils@4.9.0%gcc@14.2.0 build_system=autotools patches=440b954 arch=linux-ubuntu24.04-zen2
 -           ^numactl@2.0.18%gcc@14.2.0 build_system=autotools arch=linux-ubuntu24.04-zen2
 -           ^openssh@9.9p1%gcc@14.2.0+gssapi build_system=autotools arch=linux-ubuntu24.04-zen2
 -               ^krb5@1.21.3%gcc@14.2.0+shared build_system=autotools arch=linux-ubuntu24.04-zen2
 -                   ^bison@3.8.2%gcc@14.2.0~color build_system=autotools arch=linux-ubuntu24.04-zen2
 -                   ^gettext@0.22.5%gcc@14.2.0+bzip2+curses+git~libunistring+libxml2+pic+shared+tar+xz build_system=autotools arch=linux-ubuntu24.04-zen2
 -                       ^tar@1.34%gcc@14.2.0 build_system=autotools zip=pigz arch=linux-ubuntu24.04-zen2
 -                           ^pigz@2.8%gcc@14.2.0 build_system=makefile arch=linux-ubuntu24.04-zen2
 -               ^libedit@3.1-20240808%gcc@14.2.0 build_system=autotools arch=linux-ubuntu24.04-zen2
 -               ^libxcrypt@4.4.35%gcc@14.2.0~obsolete_api build_system=autotools patches=4885da3 arch=linux-ubuntu24.04-zen2
 -           ^perl@5.40.0%gcc@14.2.0+cpanm+opcode+open+shared+threads build_system=generic arch=linux-ubuntu24.04-zen2
 -               ^berkeley-db@18.1.40%gcc@14.2.0+cxx~docs+stl build_system=autotools patches=26090f4,b231fcc arch=linux-ubuntu24.04-zen2
 -               ^gdbm@1.23%gcc@14.2.0 build_system=autotools arch=linux-ubuntu24.04-zen2
 -                   ^readline@8.2%gcc@14.2.0 build_system=autotools patches=bbf97f1 arch=linux-ubuntu24.04-zen2
 -           ^pmix@5.0.3%gcc@14.2.0~munge~python~restful build_system=autotools arch=linux-ubuntu24.04-zen2
 -       ^zlib-ng@2.2.1%gcc@14.2.0+compat+new_strategies+opt+pic+shared build_system=autotools arch=linux-ubuntu24.04-zen2
 -       ^zstd@1.5.6%gcc@14.2.0+programs build_system=makefile compression=none libs=shared,static arch=linux-ubuntu24.04-zen2
</pre></div>
</div>
<p>In theory, Spack doesn’t need any additional installation; just
download and run!  But in real life, additional steps are usually
required before Spack can work in a practical sense.  Read on…</p>
</section>
<section id="clean-environment">
<h3>Clean Environment<a class="headerlink" href="#clean-environment" title="Link to this heading"></a></h3>
<p>Many packages’ installs can be broken by changing environment
variables.  For example, a package might pick up the wrong build-time
dependencies (most of them not specified) depending on the setting of
<code class="docutils literal notranslate"><span class="pre">PATH</span></code>.  <code class="docutils literal notranslate"><span class="pre">GCC</span></code> seems to be particularly vulnerable to these issues.</p>
<p>Therefore, it is recommended that Spack users run with a <em>clean
environment</em>, especially for <code class="docutils literal notranslate"><span class="pre">PATH</span></code>.  Only software that comes with
the system, or that you know you wish to use with Spack, should be
included.  This procedure will avoid many strange build errors.</p>
</section>
<section id="optional-alternate-prefix">
<h3>Optional: Alternate Prefix<a class="headerlink" href="#optional-alternate-prefix" title="Link to this heading"></a></h3>
<p>You may want to run Spack out of a prefix other than the git repository
you cloned.  The <code class="docutils literal notranslate"><span class="pre">spack</span> <span class="pre">clone</span></code> command provides this
functionality.  To install spack in a new directory, simply type:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>spack<span class="w"> </span>clone<span class="w"> </span>/my/favorite/prefix
</pre></div>
</div>
<p>This will install a new spack script in <code class="docutils literal notranslate"><span class="pre">/my/favorite/prefix/bin</span></code>,
which you can use just like you would the regular spack script.  Each
copy of spack installs packages into its own <code class="docutils literal notranslate"><span class="pre">$PREFIX/opt</span></code>
directory.</p>
</section>
</section>
<section id="compiler-configuration">
<span id="compiler-config"></span><h2>Compiler configuration<a class="headerlink" href="#compiler-configuration" title="Link to this heading"></a></h2>
<p>Spack has the ability to build packages with multiple compilers and
compiler versions. Compilers can be made available to Spack by
specifying them manually in <code class="docutils literal notranslate"><span class="pre">compilers.yaml</span></code> or <code class="docutils literal notranslate"><span class="pre">packages.yaml</span></code>,
or automatically by running <code class="docutils literal notranslate"><span class="pre">spack</span> <span class="pre">compiler</span> <span class="pre">find</span></code>, but for
convenience Spack will automatically detect compilers the first time
it needs them.</p>
<section id="spack-compilers">
<span id="cmd-spack-compilers"></span><h3><code class="docutils literal notranslate"><span class="pre">spack</span> <span class="pre">compilers</span></code><a class="headerlink" href="#spack-compilers" title="Link to this heading"></a></h3>
<p>You can see which compilers are available to Spack by running <code class="docutils literal notranslate"><span class="pre">spack</span>
<span class="pre">compilers</span></code> or <code class="docutils literal notranslate"><span class="pre">spack</span> <span class="pre">compiler</span> <span class="pre">list</span></code>:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>spack<span class="w"> </span>compilers
<span class="go">==&gt; Available compilers</span>
<span class="go">-- gcc ---------------------------------------------------------</span>
<span class="go">    gcc@4.9.0  gcc@4.8.0  gcc@4.7.0  gcc@4.6.2  gcc@4.4.7</span>
<span class="go">    gcc@4.8.2  gcc@4.7.1  gcc@4.6.3  gcc@4.6.1  gcc@4.1.2</span>
<span class="go">-- intel -------------------------------------------------------</span>
<span class="go">    intel@15.0.0  intel@14.0.0  intel@13.0.0  intel@12.1.0  intel@10.0</span>
<span class="go">    intel@14.0.3  intel@13.1.1  intel@12.1.5  intel@12.0.4  intel@9.1</span>
<span class="go">    intel@14.0.2  intel@13.1.0  intel@12.1.3  intel@11.1</span>
<span class="go">    intel@14.0.1  intel@13.0.1  intel@12.1.2  intel@10.1</span>
<span class="go">-- clang -------------------------------------------------------</span>
<span class="go">    clang@3.4  clang@3.3  clang@3.2  clang@3.1</span>
<span class="go">-- pgi ---------------------------------------------------------</span>
<span class="go">    pgi@14.3-0   pgi@13.2-0  pgi@12.1-0   pgi@10.9-0  pgi@8.0-1</span>
<span class="go">    pgi@13.10-0  pgi@13.1-1  pgi@11.10-0  pgi@10.2-0  pgi@7.1-3</span>
<span class="go">    pgi@13.6-0   pgi@12.8-0  pgi@11.1-0   pgi@9.0-4   pgi@7.0-6</span>
</pre></div>
</div>
<p>Any of these compilers can be used to build Spack packages.  More on
how this is done is in <a class="reference internal" href="basic_usage.html#sec-specs"><span class="std std-ref">Specs &amp; dependencies</span></a>.</p>
</section>
<section id="spack-compiler-add">
<span id="cmd-spack-compiler-add"></span><h3><code class="docutils literal notranslate"><span class="pre">spack</span> <span class="pre">compiler</span> <span class="pre">add</span></code><a class="headerlink" href="#spack-compiler-add" title="Link to this heading"></a></h3>
<p>An alias for <code class="docutils literal notranslate"><span class="pre">spack</span> <span class="pre">compiler</span> <span class="pre">find</span></code>.</p>
</section>
<section id="spack-compiler-find">
<span id="cmd-spack-compiler-find"></span><h3><code class="docutils literal notranslate"><span class="pre">spack</span> <span class="pre">compiler</span> <span class="pre">find</span></code><a class="headerlink" href="#spack-compiler-find" title="Link to this heading"></a></h3>
<p>Lists the compilers currently available to Spack. If you do not see
a compiler in this list, but you want to use it with Spack, you can
simply run <code class="docutils literal notranslate"><span class="pre">spack</span> <span class="pre">compiler</span> <span class="pre">find</span></code> with the path to where the
compiler is installed.  For example:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>spack<span class="w"> </span>compiler<span class="w"> </span>find<span class="w"> </span>/usr/local/tools/ic-13.0.079
<span class="go">==&gt; Added 1 new compiler to ~/.spack/linux/compilers.yaml</span>
<span class="go">    intel@13.0.079</span>
</pre></div>
</div>
<p>Or you can run <code class="docutils literal notranslate"><span class="pre">spack</span> <span class="pre">compiler</span> <span class="pre">find</span></code> with no arguments to force
auto-detection.  This is useful if you do not know where compilers are
installed, but you know that new compilers have been added to your
<code class="docutils literal notranslate"><span class="pre">PATH</span></code>.  For example, you might load a module, like this:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>module<span class="w"> </span>load<span class="w"> </span>gcc/4.9.0
<span class="gp">$ </span>spack<span class="w"> </span>compiler<span class="w"> </span>find
<span class="go">==&gt; Added 1 new compiler to ~/.spack/linux/compilers.yaml</span>
<span class="go">    gcc@4.9.0</span>
</pre></div>
</div>
<p>This loads the environment module for gcc-4.9.0 to add it to
<code class="docutils literal notranslate"><span class="pre">PATH</span></code>, and then it adds the compiler to Spack.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>By default, spack does not fill in the <code class="docutils literal notranslate"><span class="pre">modules:</span></code> field in the
<code class="docutils literal notranslate"><span class="pre">compilers.yaml</span></code> file.  If you are using a compiler from a
module, then you should add this field manually.
See the section on <a class="reference internal" href="#compilers-requiring-modules"><span class="std std-ref">Compilers Requiring Modules</span></a>.</p>
</div>
</section>
<section id="spack-compiler-info">
<span id="cmd-spack-compiler-info"></span><h3><code class="docutils literal notranslate"><span class="pre">spack</span> <span class="pre">compiler</span> <span class="pre">info</span></code><a class="headerlink" href="#spack-compiler-info" title="Link to this heading"></a></h3>
<p>If you want to see specifics on a particular compiler, you can run
<code class="docutils literal notranslate"><span class="pre">spack</span> <span class="pre">compiler</span> <span class="pre">info</span></code> on it:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>spack<span class="w"> </span>compiler<span class="w"> </span>info<span class="w"> </span>intel@15
<span class="go">intel@15.0.0:</span>
<span class="go">  paths:</span>
<span class="go">    cc  = /usr/local/bin/icc-15.0.090</span>
<span class="go">    cxx = /usr/local/bin/icpc-15.0.090</span>
<span class="go">    f77 = /usr/local/bin/ifort-15.0.090</span>
<span class="go">    fc  = /usr/local/bin/ifort-15.0.090</span>
<span class="go">  modules = []</span>
<span class="go">  operating_system = centos6</span>
<span class="go">...</span>
</pre></div>
</div>
<p>This shows which C, C++, and Fortran compilers were detected by Spack.
Notice also that we didn’t have to be too specific about the
version. We just said <code class="docutils literal notranslate"><span class="pre">intel&#64;15</span></code>, and information about the only
matching Intel compiler was displayed.</p>
</section>
<section id="manual-compiler-configuration">
<h3>Manual compiler configuration<a class="headerlink" href="#manual-compiler-configuration" title="Link to this heading"></a></h3>
<p>If auto-detection fails, you can manually configure a compiler by
editing your <code class="docutils literal notranslate"><span class="pre">~/.spack/&lt;platform&gt;/compilers.yaml</span></code> file.  You can do this by running
<code class="docutils literal notranslate"><span class="pre">spack</span> <span class="pre">config</span> <span class="pre">edit</span> <span class="pre">compilers</span></code>, which will open the file in
<a class="reference internal" href="packaging_guide.html#controlling-the-editor"><span class="std std-ref">your favorite editor</span></a>.</p>
<p>Each compiler configuration in the file looks like this:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">compilers</span><span class="p">:</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">compiler</span><span class="p">:</span>
<span class="w">    </span><span class="nt">modules</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[]</span>
<span class="w">    </span><span class="nt">operating_system</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">centos6</span>
<span class="w">    </span><span class="nt">paths</span><span class="p">:</span>
<span class="w">      </span><span class="nt">cc</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/usr/local/bin/icc-15.0.024-beta</span>
<span class="w">      </span><span class="nt">cxx</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/usr/local/bin/icpc-15.0.024-beta</span>
<span class="w">      </span><span class="nt">f77</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/usr/local/bin/ifort-15.0.024-beta</span>
<span class="w">      </span><span class="nt">fc</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/usr/local/bin/ifort-15.0.024-beta</span>
<span class="w">    </span><span class="nt">spec</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">intel@15.0.0</span>
</pre></div>
</div>
<p>For compilers that do not support Fortran (like <code class="docutils literal notranslate"><span class="pre">clang</span></code>), put
<code class="docutils literal notranslate"><span class="pre">None</span></code> for <code class="docutils literal notranslate"><span class="pre">f77</span></code> and <code class="docutils literal notranslate"><span class="pre">fc</span></code>:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">compilers</span><span class="p">:</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">compiler</span><span class="p">:</span>
<span class="w">    </span><span class="nt">modules</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[]</span>
<span class="w">    </span><span class="nt">operating_system</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">centos6</span>
<span class="w">    </span><span class="nt">paths</span><span class="p">:</span>
<span class="w">      </span><span class="nt">cc</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/usr/bin/clang</span>
<span class="w">      </span><span class="nt">cxx</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/usr/bin/clang++</span>
<span class="w">      </span><span class="nt">f77</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">None</span>
<span class="w">      </span><span class="nt">fc</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">None</span>
<span class="w">    </span><span class="nt">spec</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">clang@3.3svn</span>
</pre></div>
</div>
<p>Once you save the file, the configured compilers will show up in the
list displayed by <code class="docutils literal notranslate"><span class="pre">spack</span> <span class="pre">compilers</span></code>.</p>
<p>You can also add compiler flags to manually configured compilers. These
flags should be specified in the <code class="docutils literal notranslate"><span class="pre">flags</span></code> section of the compiler
specification. The valid flags are <code class="docutils literal notranslate"><span class="pre">cflags</span></code>, <code class="docutils literal notranslate"><span class="pre">cxxflags</span></code>, <code class="docutils literal notranslate"><span class="pre">fflags</span></code>,
<code class="docutils literal notranslate"><span class="pre">cppflags</span></code>, <code class="docutils literal notranslate"><span class="pre">ldflags</span></code>, and <code class="docutils literal notranslate"><span class="pre">ldlibs</span></code>. For example:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">compilers</span><span class="p">:</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">compiler</span><span class="p">:</span>
<span class="w">    </span><span class="nt">modules</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[]</span>
<span class="w">    </span><span class="nt">operating_system</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">centos6</span>
<span class="w">    </span><span class="nt">paths</span><span class="p">:</span>
<span class="w">      </span><span class="nt">cc</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/usr/bin/gcc</span>
<span class="w">      </span><span class="nt">cxx</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/usr/bin/g++</span>
<span class="w">      </span><span class="nt">f77</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/usr/bin/gfortran</span>
<span class="w">      </span><span class="nt">fc</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/usr/bin/gfortran</span>
<span class="w">    </span><span class="nt">flags</span><span class="p">:</span>
<span class="w">      </span><span class="nt">cflags</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">-O3 -fPIC</span>
<span class="w">      </span><span class="nt">cxxflags</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">-O3 -fPIC</span>
<span class="w">      </span><span class="nt">cppflags</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">-O3 -fPIC</span>
<span class="w">    </span><span class="nt">spec</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">gcc@4.7.2</span>
</pre></div>
</div>
<p>These flags will be treated by spack as if they were entered from
the command line each time this compiler is used. The compiler wrappers
then inject those flags into the compiler command. Compiler flags
entered from the command line will be discussed in more detail in the
following section.</p>
<p>Some compilers also require additional environment configuration.
Examples include Intels oneAPI and AMDs AOCC compiler suites,
which have custom scripts for loading environment variables and setting paths.
These variables should be specified in the <code class="docutils literal notranslate"><span class="pre">environment</span></code> section of the compiler
specification. The operations available to modify the environment are <code class="docutils literal notranslate"><span class="pre">set</span></code>, <code class="docutils literal notranslate"><span class="pre">unset</span></code>,
<code class="docutils literal notranslate"><span class="pre">prepend_path</span></code>, <code class="docutils literal notranslate"><span class="pre">append_path</span></code>, and <code class="docutils literal notranslate"><span class="pre">remove_path</span></code>. For example:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">compilers</span><span class="p">:</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">compiler</span><span class="p">:</span>
<span class="w">    </span><span class="nt">modules</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[]</span>
<span class="w">    </span><span class="nt">operating_system</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">centos6</span>
<span class="w">    </span><span class="nt">paths</span><span class="p">:</span>
<span class="w">      </span><span class="nt">cc</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/opt/intel/oneapi/compiler/latest/linux/bin/icx</span>
<span class="w">      </span><span class="nt">cxx</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/opt/intel/oneapi/compiler/latest/linux/bin/icpx</span>
<span class="w">      </span><span class="nt">f77</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/opt/intel/oneapi/compiler/latest/linux/bin/ifx</span>
<span class="w">      </span><span class="nt">fc</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/opt/intel/oneapi/compiler/latest/linux/bin/ifx</span>
<span class="w">    </span><span class="nt">spec</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">oneapi@latest</span>
<span class="w">    </span><span class="nt">environment</span><span class="p">:</span>
<span class="w">      </span><span class="nt">set</span><span class="p">:</span>
<span class="w">        </span><span class="nt">MKL_ROOT</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;/path/to/mkl/root&quot;</span>
<span class="w">      </span><span class="nt">unset</span><span class="p">:</span><span class="w"> </span><span class="c1"># A list of environment variables to unset</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">CC</span>
<span class="w">      </span><span class="nt">prepend_path</span><span class="p">:</span><span class="w"> </span><span class="c1"># Similar for append|remove_path</span>
<span class="w">        </span><span class="nt">LD_LIBRARY_PATH</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/ld/paths/added/by/setvars/sh</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Spack is in the process of moving compilers from a separate
attribute to be handled like all other packages. As part of this
process, the <code class="docutils literal notranslate"><span class="pre">compilers.yaml</span></code> section will eventually be replaced
by configuration in the <code class="docutils literal notranslate"><span class="pre">packages.yaml</span></code> section. This new
configuration is now available, although it is not yet the default
behavior.</p>
</div>
<p>Compilers can also be configured as external packages in the
<code class="docutils literal notranslate"><span class="pre">packages.yaml</span></code> config file. Any external package for a compiler
(e.g. <code class="docutils literal notranslate"><span class="pre">gcc</span></code> or <code class="docutils literal notranslate"><span class="pre">llvm</span></code>) will be treated as a configured compiler
assuming the paths to the compiler executables are determinable from
the prefix.</p>
<p>If the paths to the compiler executable are not determinable from the
prefix, you can add them to the <code class="docutils literal notranslate"><span class="pre">extra_attributes</span></code> field. Similarly,
all other fields from the compilers config can be added to the
<code class="docutils literal notranslate"><span class="pre">extra_attributes</span></code> field for an external representing a compiler.</p>
<p>Note that the format for the <code class="docutils literal notranslate"><span class="pre">paths</span></code> field in the
<code class="docutils literal notranslate"><span class="pre">extra_attributes</span></code> section is different than in the <code class="docutils literal notranslate"><span class="pre">compilers</span></code>
config. For compilers configured as external packages, the section is
named <code class="docutils literal notranslate"><span class="pre">compilers</span></code> and the dictionary maps language names (<code class="docutils literal notranslate"><span class="pre">c</span></code>,
<code class="docutils literal notranslate"><span class="pre">cxx</span></code>, <code class="docutils literal notranslate"><span class="pre">fortran</span></code>) to paths, rather than using the names <code class="docutils literal notranslate"><span class="pre">cc</span></code>,
<code class="docutils literal notranslate"><span class="pre">fc</span></code>, and <code class="docutils literal notranslate"><span class="pre">f77</span></code>.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">packages</span><span class="p">:</span>
<span class="w">  </span><span class="nt">gcc</span><span class="p">:</span>
<span class="w">    </span><span class="nt">external</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">spec</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">gcc@12.2.0 arch=linux-rhel8-skylake</span>
<span class="w">      </span><span class="nt">prefix</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/usr</span>
<span class="w">      </span><span class="nt">extra_attributes</span><span class="p">:</span>
<span class="w">        </span><span class="nt">environment</span><span class="p">:</span>
<span class="w">          </span><span class="nt">set</span><span class="p">:</span>
<span class="w">            </span><span class="nt">GCC_ROOT</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/usr</span>
<span class="w">    </span><span class="nt">external</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">spec</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">llvm+clang@15.0.0 arch=linux-rhel8-skylake</span>
<span class="w">      </span><span class="nt">prefix</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/usr</span>
<span class="w">      </span><span class="nt">extra_attributes</span><span class="p">:</span>
<span class="w">        </span><span class="nt">compilers</span><span class="p">:</span>
<span class="w">          </span><span class="nt">c</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/usr/bin/clang-with-suffix</span>
<span class="w">          </span><span class="nt">cxx</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/usr/bin/clang++-with-extra-info</span>
<span class="w">          </span><span class="nt">fortran</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/usr/bin/gfortran</span>
<span class="w">        </span><span class="nt">extra_rpaths</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/usr/lib/llvm/</span>
</pre></div>
</div>
</section>
<section id="build-your-own-compiler">
<h3>Build Your Own Compiler<a class="headerlink" href="#build-your-own-compiler" title="Link to this heading"></a></h3>
<p>If you are particular about which compiler/version you use, you might
wish to have Spack build it for you.  For example:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>spack<span class="w"> </span>install<span class="w"> </span>gcc@4.9.3
</pre></div>
</div>
<p>Once that has finished, you will need to add it to your
<code class="docutils literal notranslate"><span class="pre">compilers.yaml</span></code> file.  You can then set Spack to use it by default
by adding the following to your <code class="docutils literal notranslate"><span class="pre">packages.yaml</span></code> file:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">packages</span><span class="p">:</span>
<span class="w">  </span><span class="nt">all</span><span class="p">:</span>
<span class="w">    </span><span class="nt">compiler</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">gcc@4.9.3</span><span class="p p-Indicator">]</span>
</pre></div>
</div>
</section>
<section id="compilers-requiring-modules">
<span id="id3"></span><h3>Compilers Requiring Modules<a class="headerlink" href="#compilers-requiring-modules" title="Link to this heading"></a></h3>
<p>Many installed compilers will work regardless of the environment they
are called with.  However, some installed compilers require
<code class="docutils literal notranslate"><span class="pre">$LD_LIBRARY_PATH</span></code> or other environment variables to be set in order
to run; this is typical for Intel and other proprietary compilers.</p>
<p>In such a case, you should tell Spack which module(s) to load in order
to run the chosen compiler (If the compiler does not come with a
module file, you might consider making one by hand).  Spack will load
this module into the environment ONLY when the compiler is run, and
NOT in general for a package’s <code class="docutils literal notranslate"><span class="pre">install()</span></code> method.  See, for
example, this <code class="docutils literal notranslate"><span class="pre">compilers.yaml</span></code> file:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">compilers</span><span class="p">:</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">compiler</span><span class="p">:</span>
<span class="w">    </span><span class="nt">modules</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">other/comp/gcc-5.3-sp3</span><span class="p p-Indicator">]</span>
<span class="w">    </span><span class="nt">operating_system</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">SuSE11</span>
<span class="w">    </span><span class="nt">paths</span><span class="p">:</span>
<span class="w">      </span><span class="nt">cc</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/usr/local/other/SLES11.3/gcc/5.3.0/bin/gcc</span>
<span class="w">      </span><span class="nt">cxx</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/usr/local/other/SLES11.3/gcc/5.3.0/bin/g++</span>
<span class="w">      </span><span class="nt">f77</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/usr/local/other/SLES11.3/gcc/5.3.0/bin/gfortran</span>
<span class="w">      </span><span class="nt">fc</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/usr/local/other/SLES11.3/gcc/5.3.0/bin/gfortran</span>
<span class="w">    </span><span class="nt">spec</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">gcc@5.3.0</span>
</pre></div>
</div>
<p>Some compilers require special environment settings to be loaded not just
to run, but also to execute the code they build, breaking packages that
need to execute code they just compiled.  If it’s not possible or
practical to use a better compiler, you’ll need to ensure that
environment settings are preserved for compilers like this (i.e., you’ll
need to load the module or source the compiler’s shell script).</p>
<p>By default, Spack tries to ensure that builds are reproducible by
cleaning the environment before building.  If this interferes with your
compiler settings, you CAN use <code class="docutils literal notranslate"><span class="pre">spack</span> <span class="pre">install</span> <span class="pre">--dirty</span></code> as a workaround.
Note that this MAY interfere with package builds.</p>
</section>
<section id="licensed-compilers">
<span id="id4"></span><h3>Licensed Compilers<a class="headerlink" href="#licensed-compilers" title="Link to this heading"></a></h3>
<p>Some proprietary compilers require licensing to use.  If you need to
use a licensed compiler (eg, PGI), the process is similar to a mix of
build your own, plus modules:</p>
<ol class="arabic simple">
<li><p>Create a Spack package (if it doesn’t exist already) to install
your compiler.  Follow instructions on installing <a class="reference internal" href="packaging_guide.html#license"><span class="std std-ref">Licensed software</span></a>.</p></li>
<li><p>Once the compiler is installed, you should be able to test it by
using Spack to load the module it just created, and running simple
builds (eg: <code class="docutils literal notranslate"><span class="pre">cc</span> <span class="pre">helloWorld.c</span> <span class="pre">&amp;&amp;</span> <span class="pre">./a.out</span></code>)</p></li>
<li><p>Add the newly-installed compiler to <code class="docutils literal notranslate"><span class="pre">compilers.yaml</span></code> as shown
above.</p></li>
</ol>
</section>
<section id="mixed-toolchains">
<span id="id5"></span><h3>Mixed Toolchains<a class="headerlink" href="#mixed-toolchains" title="Link to this heading"></a></h3>
<p>Modern compilers typically come with related compilers for C, C++ and
Fortran bundled together.  When possible, results are best if the same
compiler is used for all languages.</p>
<p>In some cases, this is not possible.  For example, starting with macOS El
Capitan (10.11), many packages no longer build with GCC, but XCode
provides no Fortran compilers.  The user is therefore forced to use a
mixed toolchain: XCode-provided Clang for C/C++ and GNU <code class="docutils literal notranslate"><span class="pre">gfortran</span></code> for
Fortran.</p>
<ol class="arabic">
<li><p>You need to make sure that Xcode is installed. Run the following command:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>xcode-select<span class="w"> </span>--install
</pre></div>
</div>
<p>If the Xcode command-line tools are already installed, you will see an
error message:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>xcode-select: error: command line tools are already installed, use &quot;Software Update&quot; to install updates
</pre></div>
</div>
</li>
<li><p>For most packages, the Xcode command-line tools are sufficient. However,
some packages like <code class="docutils literal notranslate"><span class="pre">qt</span></code> require the full Xcode suite. You can check
to see which you have installed by running:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>xcode-select<span class="w"> </span>-p
</pre></div>
</div>
<p>If the output is:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>/Applications/Xcode.app/Contents/Developer
</pre></div>
</div>
<p>you already have the full Xcode suite installed. If the output is:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>/Library/Developer/CommandLineTools
</pre></div>
</div>
<p>you only have the command-line tools installed. The full Xcode suite can
be installed through the App Store. Make sure you launch the Xcode
application and accept the license agreement before using Spack.
It may ask you to install additional components. Alternatively, the license
can be accepted through the command line:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>sudo<span class="w"> </span>xcodebuild<span class="w"> </span>-license<span class="w"> </span>accept
</pre></div>
</div>
<p>Note: the flag is <code class="docutils literal notranslate"><span class="pre">-license</span></code>, not <code class="docutils literal notranslate"><span class="pre">--license</span></code>.</p>
</li>
<li><p>Run <code class="docutils literal notranslate"><span class="pre">spack</span> <span class="pre">compiler</span> <span class="pre">find</span></code> to locate Clang.</p></li>
<li><p>There are different ways to get <code class="docutils literal notranslate"><span class="pre">gfortran</span></code> on macOS. For example, you can
install GCC with Spack (<code class="docutils literal notranslate"><span class="pre">spack</span> <span class="pre">install</span> <span class="pre">gcc</span></code>), with Homebrew (<code class="docutils literal notranslate"><span class="pre">brew</span> <span class="pre">install</span>
<span class="pre">gcc</span></code>), or from a <a class="reference external" href="https://github.com/fxcoudert/gfortran-for-macOS/releases">DMG installer</a>.</p></li>
<li><p>The only thing left to do is to edit <code class="docutils literal notranslate"><span class="pre">~/.spack/darwin/compilers.yaml</span></code> to provide
the path to <code class="docutils literal notranslate"><span class="pre">gfortran</span></code>:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">compilers</span><span class="p">:</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">compiler</span><span class="p">:</span>
<span class="w">  </span><span class="c1"># ...</span>
<span class="w">  </span><span class="nt">paths</span><span class="p">:</span>
<span class="w">    </span><span class="nt">cc</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/usr/bin/clang</span>
<span class="w">    </span><span class="nt">cxx</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/usr/bin/clang++</span>
<span class="w">    </span><span class="nt">f77</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/path/to/bin/gfortran</span>
<span class="w">    </span><span class="nt">fc</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/path/to/bin/gfortran</span>
<span class="w">  </span><span class="nt">spec</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">apple-clang@11.0.0</span>
</pre></div>
</div>
<p>If you used Spack to install GCC, you can get the installation prefix by
<code class="docutils literal notranslate"><span class="pre">spack</span> <span class="pre">location</span> <span class="pre">-i</span> <span class="pre">gcc</span></code> (this will only work if you have a single version
of GCC installed). Whereas for Homebrew, GCC is installed in
<code class="docutils literal notranslate"><span class="pre">/usr/local/Cellar/gcc/x.y.z</span></code>. With the DMG installer, the correct path
will be <code class="docutils literal notranslate"><span class="pre">/usr/local/gfortran</span></code>.</p>
</li>
</ol>
</section>
<section id="compiler-verification">
<h3>Compiler Verification<a class="headerlink" href="#compiler-verification" title="Link to this heading"></a></h3>
<p>You can verify that your compilers are configured properly by installing a
simple package.  For example:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>spack<span class="w"> </span>install<span class="w"> </span>zlib%gcc@5.3.0
</pre></div>
</div>
</section>
</section>
<section id="vendor-specific-compiler-configuration">
<span id="id6"></span><h2>Vendor-Specific Compiler Configuration<a class="headerlink" href="#vendor-specific-compiler-configuration" title="Link to this heading"></a></h2>
<p>With Spack, things usually “just work” with GCC.  Not so for other
compilers.  This section provides details on how to get specific
compilers working.</p>
<section id="intel-compilers">
<h3>Intel Compilers<a class="headerlink" href="#intel-compilers" title="Link to this heading"></a></h3>
<p>Intel compilers are unusual because a single Intel compiler version
can emulate multiple GCC versions.  In order to provide this
functionality, the Intel compiler needs GCC to be installed.
Therefore, the following steps are necessary to successfully use Intel
compilers:</p>
<ol class="arabic">
<li><p>Install a version of GCC that implements the desired language
features (<code class="docutils literal notranslate"><span class="pre">spack</span> <span class="pre">install</span> <span class="pre">gcc</span></code>).</p></li>
<li><p>Tell the Intel compiler how to find that desired GCC.  This may be
done in one of two ways:</p>
<blockquote>
<div><p>“By default, the compiler determines which version of <code class="docutils literal notranslate"><span class="pre">gcc</span></code> or <code class="docutils literal notranslate"><span class="pre">g++</span></code>
you have installed from the <code class="docutils literal notranslate"><span class="pre">PATH</span></code> environment variable.</p>
<p>If you want use a version of <code class="docutils literal notranslate"><span class="pre">gcc</span></code> or <code class="docutils literal notranslate"><span class="pre">g++</span></code> other than the default
version on your system, you need to use either the <code class="docutils literal notranslate"><span class="pre">-gcc-name</span></code>
or <code class="docutils literal notranslate"><span class="pre">-gxx-name</span></code> compiler option to specify the path to the version of
<code class="docutils literal notranslate"><span class="pre">gcc</span></code> or <code class="docutils literal notranslate"><span class="pre">g++</span></code> that you want to use.”</p>
<p class="attribution">—<a class="reference external" href="https://software.intel.com/en-us/node/522750">Intel Reference Guide</a></p>
</div></blockquote>
</li>
</ol>
<p>Intel compilers may therefore be configured in one of two ways with
Spack: using modules, or using compiler flags.</p>
<section id="configuration-with-modules">
<h4>Configuration with Modules<a class="headerlink" href="#configuration-with-modules" title="Link to this heading"></a></h4>
<p>One can control which GCC is seen by the Intel compiler with modules.
A module must be loaded both for the Intel Compiler (so it will run)
and GCC (so the compiler can find the intended GCC).  The following
configuration in <code class="docutils literal notranslate"><span class="pre">compilers.yaml</span></code> illustrates this technique:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">compilers</span><span class="p">:</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">compiler</span><span class="p">:</span>
<span class="w">    </span><span class="nt">modules</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">gcc-4.9.3</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">intel-15.0.24</span><span class="p p-Indicator">]</span>
<span class="w">    </span><span class="nt">operating_system</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">centos7</span>
<span class="w">    </span><span class="nt">paths</span><span class="p">:</span>
<span class="w">      </span><span class="nt">cc</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/opt/intel-15.0.24/bin/icc-15.0.24-beta</span>
<span class="w">      </span><span class="nt">cxx</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/opt/intel-15.0.24/bin/icpc-15.0.24-beta</span>
<span class="w">      </span><span class="nt">f77</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/opt/intel-15.0.24/bin/ifort-15.0.24-beta</span>
<span class="w">      </span><span class="nt">fc</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/opt/intel-15.0.24/bin/ifort-15.0.24-beta</span>
<span class="w">    </span><span class="nt">spec</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">intel@15.0.24.4.9.3</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The version number on the Intel compiler is a combination of
the “native” Intel version number and the GNU compiler it is
targeting.</p>
</div>
</section>
<section id="command-line-configuration">
<h4>Command Line Configuration<a class="headerlink" href="#command-line-configuration" title="Link to this heading"></a></h4>
<p>One can also control which GCC is seen by the Intel compiler by adding
flags to the <code class="docutils literal notranslate"><span class="pre">icc</span></code> command:</p>
<ol class="arabic">
<li><p>Identify the location of the compiler you just installed:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>spack<span class="w"> </span>location<span class="w"> </span>--install-dir<span class="w"> </span>gcc
<span class="go">~/spack/opt/spack/linux-centos7-x86_64/gcc-4.9.3-iy4rw...</span>
</pre></div>
</div>
</li>
<li><p>Set up <code class="docutils literal notranslate"><span class="pre">compilers.yaml</span></code>, for example:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">compilers</span><span class="p">:</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">compiler</span><span class="p">:</span>
<span class="w">    </span><span class="nt">modules</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">intel-15.0.24</span><span class="p p-Indicator">]</span>
<span class="w">    </span><span class="nt">operating_system</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">centos7</span>
<span class="w">    </span><span class="nt">paths</span><span class="p">:</span>
<span class="w">      </span><span class="nt">cc</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/opt/intel-15.0.24/bin/icc-15.0.24-beta</span>
<span class="w">      </span><span class="nt">cxx</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/opt/intel-15.0.24/bin/icpc-15.0.24-beta</span>
<span class="w">      </span><span class="nt">f77</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/opt/intel-15.0.24/bin/ifort-15.0.24-beta</span>
<span class="w">      </span><span class="nt">fc</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/opt/intel-15.0.24/bin/ifort-15.0.24-beta</span>
<span class="w">    </span><span class="nt">flags</span><span class="p">:</span>
<span class="w">      </span><span class="nt">cflags</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">-gcc-name ~/spack/opt/spack/linux-centos7-x86_64/gcc-4.9.3-iy4rw.../bin/gcc</span>
<span class="w">      </span><span class="nt">cxxflags</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">-gxx-name ~/spack/opt/spack/linux-centos7-x86_64/gcc-4.9.3-iy4rw.../bin/g++</span>
<span class="w">      </span><span class="nt">fflags</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">-gcc-name ~/spack/opt/spack/linux-centos7-x86_64/gcc-4.9.3-iy4rw.../bin/gcc</span>
<span class="w">    </span><span class="nt">spec</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">intel@15.0.24.4.9.3</span>
</pre></div>
</div>
</li>
</ol>
</section>
</section>
<section id="pgi">
<h3>PGI<a class="headerlink" href="#pgi" title="Link to this heading"></a></h3>
<p>PGI comes with two sets of compilers for C++ and Fortran,
distinguishable by their names.  “Old” compilers:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">cc</span><span class="p">:</span><span class="w">  </span><span class="l l-Scalar l-Scalar-Plain">/soft/pgi/15.10/linux86-64/15.10/bin/pgcc</span>
<span class="nt">cxx</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/soft/pgi/15.10/linux86-64/15.10/bin/pgCC</span>
<span class="nt">f77</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/soft/pgi/15.10/linux86-64/15.10/bin/pgf77</span>
<span class="nt">fc</span><span class="p">:</span><span class="w">  </span><span class="l l-Scalar l-Scalar-Plain">/soft/pgi/15.10/linux86-64/15.10/bin/pgf90</span>
</pre></div>
</div>
<p>“New” compilers:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">cc</span><span class="p">:</span><span class="w">  </span><span class="l l-Scalar l-Scalar-Plain">/soft/pgi/15.10/linux86-64/15.10/bin/pgcc</span>
<span class="nt">cxx</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/soft/pgi/15.10/linux86-64/15.10/bin/pgc++</span>
<span class="nt">f77</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/soft/pgi/15.10/linux86-64/15.10/bin/pgfortran</span>
<span class="nt">fc</span><span class="p">:</span><span class="w">  </span><span class="l l-Scalar l-Scalar-Plain">/soft/pgi/15.10/linux86-64/15.10/bin/pgfortran</span>
</pre></div>
</div>
<p>Older installations of PGI contains just the old compilers; whereas
newer installations contain the old and the new.  The new compiler is
considered preferable, as some packages
(<code class="docutils literal notranslate"><span class="pre">hdf</span></code>) will not build with the old compiler.</p>
<p>When auto-detecting a PGI compiler, there are cases where Spack will
find the old compilers, when you really want it to find the new
compilers.  It is best to check this <code class="docutils literal notranslate"><span class="pre">compilers.yaml</span></code>; and if the old
compilers are being used, change <code class="docutils literal notranslate"><span class="pre">pgf77</span></code> and <code class="docutils literal notranslate"><span class="pre">pgf90</span></code> to
<code class="docutils literal notranslate"><span class="pre">pgfortran</span></code>.</p>
<p>Other issues:</p>
<ul>
<li><p>There are reports that some packages will not build with PGI,
including <code class="docutils literal notranslate"><span class="pre">libpciaccess</span></code> and <code class="docutils literal notranslate"><span class="pre">openssl</span></code>.  A workaround is to
build these packages with another compiler and then use them as
dependencies for PGI-build packages.  For example:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>spack<span class="w"> </span>install<span class="w"> </span>openmpi%pgi<span class="w"> </span>^libpciaccess%gcc
</pre></div>
</div>
</li>
<li><p>PGI requires a license to use; see <a class="reference internal" href="#licensed-compilers"><span class="std std-ref">Licensed Compilers</span></a> for more
information on installation.</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>It is believed the problem with HDF 4 is that everything is
compiled with the <code class="docutils literal notranslate"><span class="pre">F77</span></code> compiler, but at some point some Fortran
90 code slipped in there. So compilers that can handle both FORTRAN
77 and Fortran 90 (<code class="docutils literal notranslate"><span class="pre">gfortran</span></code>, <code class="docutils literal notranslate"><span class="pre">pgfortran</span></code>, etc) are fine.  But
compilers specific to one or the other (<code class="docutils literal notranslate"><span class="pre">pgf77</span></code>, <code class="docutils literal notranslate"><span class="pre">pgf90</span></code>) won’t
work.</p>
</div>
</section>
<section id="nag">
<h3>NAG<a class="headerlink" href="#nag" title="Link to this heading"></a></h3>
<p>The Numerical Algorithms Group provides a licensed Fortran compiler. Like Clang,
this requires you to set up a <a class="reference internal" href="#mixed-toolchains"><span class="std std-ref">Mixed Toolchains</span></a>. It is recommended to use
GCC for your C/C++ compilers.</p>
<p>The NAG Fortran compilers are a bit more strict than other compilers, and many
packages will fail to install with error messages like:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Error: mpi_comm_spawn_multiple_f90.f90: Argument 3 to MPI_COMM_SPAWN_MULTIPLE has data type DOUBLE PRECISION in reference from MPI_COMM_SPAWN_MULTIPLEN and CHARACTER in reference from MPI_COMM_SPAWN_MULTIPLEA
</pre></div>
</div>
<p>In order to convince the NAG compiler not to be too picky about calling conventions,
you can use <code class="docutils literal notranslate"><span class="pre">FFLAGS=-mismatch</span></code> and <code class="docutils literal notranslate"><span class="pre">FCFLAGS=-mismatch</span></code>. This can be done through
the command line:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>spack<span class="w"> </span>install<span class="w"> </span>openmpi<span class="w"> </span><span class="nv">fflags</span><span class="o">=</span><span class="s2">&quot;-mismatch&quot;</span>
</pre></div>
</div>
<p>Or it can be set permanently in your <code class="docutils literal notranslate"><span class="pre">compilers.yaml</span></code>:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">compiler</span><span class="p">:</span>
<span class="w w-Error"> </span><span class="nt">modules</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[]</span>
<span class="w"> </span><span class="nt">operating_system</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">centos6</span>
<span class="w"> </span><span class="nt">paths</span><span class="p">:</span>
<span class="w">   </span><span class="nt">cc</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/soft/spack/opt/spack/linux-x86_64/gcc-5.3.0/gcc-6.1.0-q2zosj3igepi3pjnqt74bwazmptr5gpj/bin/gcc</span>
<span class="w">   </span><span class="nt">cxx</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/soft/spack/opt/spack/linux-x86_64/gcc-5.3.0/gcc-6.1.0-q2zosj3igepi3pjnqt74bwazmptr5gpj/bin/g++</span>
<span class="w">   </span><span class="nt">f77</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/soft/spack/opt/spack/linux-x86_64/gcc-4.4.7/nag-6.1-jt3h5hwt5myezgqguhfsan52zcskqene/bin/nagfor</span>
<span class="w">   </span><span class="nt">fc</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/soft/spack/opt/spack/linux-x86_64/gcc-4.4.7/nag-6.1-jt3h5hwt5myezgqguhfsan52zcskqene/bin/nagfor</span>
<span class="w"> </span><span class="nt">flags</span><span class="p">:</span>
<span class="w">   </span><span class="nt">fflags</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">-mismatch</span>
<span class="w"> </span><span class="nt">spec</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">nag@6.1</span>
</pre></div>
</div>
</section>
<p></p>
</section>
<section id="system-packages">
<h2>System Packages<a class="headerlink" href="#system-packages" title="Link to this heading"></a></h2>
<p>Once compilers are configured, one needs to determine which
pre-installed system packages, if any, to use in builds.  This is
configured in the file <code class="docutils literal notranslate"><span class="pre">~/.spack/packages.yaml</span></code>.  For example, to use
an OpenMPI installed in /opt/local, one would use:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">packages</span><span class="p">:</span>
<span class="w">    </span><span class="nt">openmpi</span><span class="p">:</span>
<span class="w">        </span><span class="nt">externals</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">spec</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">openmpi@1.10.1</span>
<span class="w">          </span><span class="nt">prefix</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/opt/local</span>
<span class="w">        </span><span class="nt">buildable</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">False</span>
</pre></div>
</div>
<p>In general, Spack is easier to use and more reliable if it builds all of
its own dependencies.  However, there are several packages for which one
commonly needs to use system versions:</p>
<section id="mpi">
<h3>MPI<a class="headerlink" href="#mpi" title="Link to this heading"></a></h3>
<p>On supercomputers, sysadmins have already built MPI versions that take
into account the specifics of that computer’s hardware.  Unless you
know how they were built and can choose the correct Spack variants,
you are unlikely to get a working MPI from Spack.  Instead, use an
appropriate pre-installed MPI.</p>
<p>If you choose a pre-installed MPI, you should consider using the
pre-installed compiler used to build that MPI; see above on
<code class="docutils literal notranslate"><span class="pre">compilers.yaml</span></code>.</p>
</section>
<section id="openssl">
<h3>OpenSSL<a class="headerlink" href="#openssl" title="Link to this heading"></a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">openssl</span></code> package underlies much of modern security in a modern
OS; an attacker can easily “pwn” any computer on which they can modify SSL.
Therefore, any <code class="docutils literal notranslate"><span class="pre">openssl</span></code> used on a system should be created in a
“trusted environment” — for example, that of the OS vendor.</p>
<p>OpenSSL is also updated by the OS vendor from time to time, in
response to security problems discovered in the wider community.  It
is in everyone’s best interest to use any newly updated versions as
soon as they come out.  Modern Linux installations have standard
procedures for security updates without user involvement.</p>
<p>Spack running at user-level is not a trusted environment, nor do Spack
users generally keep up-to-date on the latest security holes in SSL.  For
these reasons, a Spack-installed OpenSSL should likely not be trusted.</p>
<p>As long as the system-provided SSL works, you can use it instead.  One
can check if it works by trying to download an <code class="docutils literal notranslate"><span class="pre">https://</span></code>.  For
example:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>curl<span class="w"> </span>-O<span class="w"> </span>https://github.com/ImageMagick/ImageMagick/archive/7.0.2-7.tar.gz
</pre></div>
</div>
<p>To tell Spack to use the system-supplied OpenSSL, first determine what
version you have:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>openssl<span class="w"> </span>version
<span class="go">OpenSSL 1.0.2g  1 Mar 2016</span>
</pre></div>
</div>
<p>Then add the following to <code class="docutils literal notranslate"><span class="pre">~/.spack/packages.yaml</span></code>:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">packages</span><span class="p">:</span>
<span class="w">    </span><span class="nt">openssl</span><span class="p">:</span>
<span class="w">        </span><span class="nt">externals</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">spec</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">openssl@1.0.2g</span>
<span class="w">          </span><span class="nt">prefix</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/usr</span>
<span class="w">        </span><span class="nt">buildable</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">False</span>
</pre></div>
</div>
</section>
<section id="blas-lapack">
<h3>BLAS / LAPACK<a class="headerlink" href="#blas-lapack" title="Link to this heading"></a></h3>
<p>The recommended way to use system-supplied BLAS / LAPACK packages is
to add the following to <code class="docutils literal notranslate"><span class="pre">packages.yaml</span></code>:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">packages</span><span class="p">:</span>
<span class="w">    </span><span class="nt">netlib-lapack</span><span class="p">:</span>
<span class="w">        </span><span class="nt">externals</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">spec</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">netlib-lapack@3.6.1</span>
<span class="w">          </span><span class="nt">prefix</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/usr</span>
<span class="w">        </span><span class="nt">buildable</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">False</span>
<span class="w">    </span><span class="nt">all</span><span class="p">:</span>
<span class="w">        </span><span class="nt">providers</span><span class="p">:</span>
<span class="w">            </span><span class="nt">blas</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">netlib-lapack</span><span class="p p-Indicator">]</span>
<span class="w">            </span><span class="nt">lapack</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">netlib-lapack</span><span class="p p-Indicator">]</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Above we pretend that the system-provided BLAS / LAPACK is <code class="docutils literal notranslate"><span class="pre">netlib-lapack</span></code>
only because it is the only BLAS / LAPACK provider which use standard names
for libraries (as opposed to, for example, <code class="docutils literal notranslate"><span class="pre">libopenblas.so</span></code>).</p>
<p>Although we specify external package in <code class="docutils literal notranslate"><span class="pre">/usr</span></code>, Spack is smart enough not
to add <code class="docutils literal notranslate"><span class="pre">/usr/lib</span></code> to RPATHs, where it could cause unrelated system
libraries to be used instead of their Spack equivalents. <code class="docutils literal notranslate"><span class="pre">usr/bin</span></code> will be
present in PATH, however it will have lower precedence compared to paths
from other dependencies. This ensures that binaries in Spack dependencies
are preferred over system binaries.</p>
</div>
</section>
<section id="git">
<h3>Git<a class="headerlink" href="#git" title="Link to this heading"></a></h3>
<p>Some Spack packages use <code class="docutils literal notranslate"><span class="pre">git</span></code> to download, which might not work on
some computers.  For example, the following error was
encountered on a Macintosh during <code class="docutils literal notranslate"><span class="pre">spack</span> <span class="pre">install</span> <span class="pre">julia&#64;master</span></code>:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">==&gt; Cloning git repository:</span>
<span class="go">  https://github.com/JuliaLang/julia.git</span>
<span class="go">  on branch master</span>
<span class="go">Cloning into &#39;julia&#39;...</span>
<span class="go">fatal: unable to access &#39;https://github.com/JuliaLang/julia.git/&#39;:</span>
<span class="go">    SSL certificate problem: unable to get local issuer certificate</span>
</pre></div>
</div>
<p>This problem is related to OpenSSL, and in some cases might be solved
by installing a new version of <code class="docutils literal notranslate"><span class="pre">git</span></code> and <code class="docutils literal notranslate"><span class="pre">openssl</span></code>:</p>
<ol class="arabic simple">
<li><p>Run <code class="docutils literal notranslate"><span class="pre">spack</span> <span class="pre">install</span> <span class="pre">git</span></code></p></li>
<li><p>Add the output of <code class="docutils literal notranslate"><span class="pre">spack</span> <span class="pre">module</span> <span class="pre">tcl</span> <span class="pre">loads</span> <span class="pre">git</span></code> to your <code class="docutils literal notranslate"><span class="pre">.bashrc</span></code>.</p></li>
</ol>
<p>If this doesn’t work, it is also possible to disable checking of SSL
certificates by using:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>spack<span class="w"> </span>--insecure<span class="w"> </span>install
</pre></div>
</div>
<p>Using <code class="docutils literal notranslate"><span class="pre">--insecure</span></code> makes Spack disable SSL checking when fetching
from websites and from git.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This workaround should be used ONLY as a last resort!  Without SSL
certificate verification, spack and git will download from sites you
wouldn’t normally trust.  The code you download and run may then be
compromised!  While this is not a major issue for archives that will
be checksummed, it is especially problematic when downloading from
name Git branches or tags, which relies entirely on trusting a
certificate for security (no verification).</p>
</div>
</section>
<p>   certificate for security (no verification).</p>
</section>
<section id="utilities-configuration">
<h2>Utilities Configuration<a class="headerlink" href="#utilities-configuration" title="Link to this heading"></a></h2>
<p>Although Spack does not need installation <em>per se</em>, it does rely on
other packages to be available on its host system.  If those packages
are out of date or missing, then Spack will not work.  Sometimes, an
appeal to the system’s package manager can fix such problems.  If not,
the solution is have Spack install the required packages, and then
have Spack use them.</p>
<p>For example, if <code class="docutils literal notranslate"><span class="pre">curl</span></code> doesn’t work, one could use the following steps
to provide Spack a working <code class="docutils literal notranslate"><span class="pre">curl</span></code>:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>spack<span class="w"> </span>install<span class="w"> </span>curl
<span class="gp">$ </span>spack<span class="w"> </span>load<span class="w"> </span>curl
</pre></div>
</div>
<p>or alternately:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>spack<span class="w"> </span>module<span class="w"> </span>tcl<span class="w"> </span>loads<span class="w"> </span>curl<span class="w"> </span>&gt;&gt;~/.bashrc
</pre></div>
</div>
<p>or if environment modules don’t work:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span><span class="nb">export</span><span class="w"> </span><span class="nv">PATH</span><span class="o">=</span><span class="sb">`</span>spack<span class="w"> </span>location<span class="w"> </span>--install-dir<span class="w"> </span>curl<span class="sb">`</span>/bin:<span class="nv">$PATH</span>
</pre></div>
</div>
<p>External commands are used by Spack in two places: within core Spack,
and in the package recipes. The bootstrapping procedure for these two
cases is somewhat different, and is treated separately below.</p>
<section id="core-spack-utilities">
<h3>Core Spack Utilities<a class="headerlink" href="#core-spack-utilities" title="Link to this heading"></a></h3>
<p>Core Spack uses the following packages, mainly to download and unpack
source code: <code class="docutils literal notranslate"><span class="pre">curl</span></code>, <code class="docutils literal notranslate"><span class="pre">env</span></code>, <code class="docutils literal notranslate"><span class="pre">git</span></code>, <code class="docutils literal notranslate"><span class="pre">go</span></code>, <code class="docutils literal notranslate"><span class="pre">hg</span></code>, <code class="docutils literal notranslate"><span class="pre">svn</span></code>,
<code class="docutils literal notranslate"><span class="pre">tar</span></code>, <code class="docutils literal notranslate"><span class="pre">unzip</span></code>, <code class="docutils literal notranslate"><span class="pre">patch</span></code></p>
<p>As long as the user’s environment is set up to successfully run these
programs from outside of Spack, they should work inside of Spack as
well.  They can generally be activated as in the <code class="docutils literal notranslate"><span class="pre">curl</span></code> example above;
or some systems might already have an appropriate hand-built
environment module that may be loaded.  Either way works.</p>
<p>A few notes on specific programs in this list:</p>
<section id="curl-git-mercurial-etc">
<h4>cURL, git, Mercurial, etc.<a class="headerlink" href="#curl-git-mercurial-etc" title="Link to this heading"></a></h4>
<p>Spack depends on cURL to download tarballs, the format that most
Spack-installed packages come in.  Your system’s cURL should always be
able to download unencrypted <code class="docutils literal notranslate"><span class="pre">http://</span></code>.  However, the cURL on some
systems has problems with SSL-enabled <code class="docutils literal notranslate"><span class="pre">https://</span></code> URLs, due to
outdated / insecure versions of OpenSSL on those systems.  This will
prevent Spack from installing any software requiring <code class="docutils literal notranslate"><span class="pre">https://</span></code>
until a new cURL has been installed, using the technique above.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>remember that if you install <code class="docutils literal notranslate"><span class="pre">curl</span></code> via Spack that it may rely on a
user-space OpenSSL that is not upgraded regularly.  It may fall out of
date faster than your system OpenSSL.</p>
</div>
<p>Some packages use source code control systems as their download method:
<code class="docutils literal notranslate"><span class="pre">git</span></code>, <code class="docutils literal notranslate"><span class="pre">hg</span></code>, <code class="docutils literal notranslate"><span class="pre">svn</span></code> and occasionally <code class="docutils literal notranslate"><span class="pre">go</span></code>.  If you had to install
a new <code class="docutils literal notranslate"><span class="pre">curl</span></code>, then chances are the system-supplied version of these
other programs will also not work, because they also rely on OpenSSL.
Once <code class="docutils literal notranslate"><span class="pre">curl</span></code> has been installed, you can similarly install the others.</p>
</section>
</section>
<section id="package-utilities">
<h3>Package Utilities<a class="headerlink" href="#package-utilities" title="Link to this heading"></a></h3>
<p>Spack may also encounter bootstrapping problems inside a package’s
<code class="docutils literal notranslate"><span class="pre">install()</span></code> method.  In this case, Spack will normally be running
inside a <em>sanitized build environment</em>.  This includes all of the
package’s dependencies, but none of the environment Spack inherited
from the user: if you load a module or modify <code class="docutils literal notranslate"><span class="pre">$PATH</span></code> before
launching Spack, it will have no effect.</p>
<p>In this case, you will likely need to use the <code class="docutils literal notranslate"><span class="pre">--dirty</span></code> flag when
running <code class="docutils literal notranslate"><span class="pre">spack</span> <span class="pre">install</span></code>, causing Spack to <strong>not</strong> sanitize the build
environment.  You are now responsible for making sure that environment
does not do strange things to Spack or its installs.</p>
<p>Another way to get Spack to use its own version of something is to add
that something to a package that needs it.  For example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">depends_on</span><span class="p">(</span><span class="s1">&#39;binutils&#39;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s1">&#39;build&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>This is considered best practice for some common build dependencies,
such as <code class="docutils literal notranslate"><span class="pre">autotools</span></code> (if the <code class="docutils literal notranslate"><span class="pre">autoreconf</span></code> command is needed) and
<code class="docutils literal notranslate"><span class="pre">cmake</span></code> — <code class="docutils literal notranslate"><span class="pre">cmake</span></code> especially, because different packages require
a different version of CMake.</p>
<section id="binutils">
<h4>binutils<a class="headerlink" href="#binutils" title="Link to this heading"></a></h4>
<p>Sometimes, strange error messages can happen while building a package.
For example, <code class="docutils literal notranslate"><span class="pre">ld</span></code> might crash.  Or one receives a message like:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">ld: final link failed: Nonrepresentable section on output</span>
</pre></div>
</div>
<p>or:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">ld: .../_fftpackmodule.o: unrecognized relocation (0x2a) in section `.text&#39;</span>
</pre></div>
</div>
<p>These problems are often caused by an outdated <code class="docutils literal notranslate"><span class="pre">binutils</span></code> on your
system.  Unlike CMake or Autotools, adding <code class="docutils literal notranslate"><span class="pre">depends_on('binutils')</span></code> to
every package is not considered a best practice because every package
written in C/C++/Fortran would need it.  A potential workaround is to
load a recent <code class="docutils literal notranslate"><span class="pre">binutils</span></code> into your environment and use the <code class="docutils literal notranslate"><span class="pre">--dirty</span></code>
flag.</p>
</section>
</section>
</section>
<section id="gpg-signing">
<h2>GPG Signing<a class="headerlink" href="#gpg-signing" title="Link to this heading"></a></h2>
<section id="spack-gpg">
<span id="cmd-spack-gpg"></span><h3><code class="docutils literal notranslate"><span class="pre">spack</span> <span class="pre">gpg</span></code><a class="headerlink" href="#spack-gpg" title="Link to this heading"></a></h3>
<p>Spack has support for signing and verifying packages using GPG keys. A
separate keyring is used for Spack, so any keys available in the user’s home
directory are not used.</p>
</section>
<section id="spack-gpg-init">
<h3><code class="docutils literal notranslate"><span class="pre">spack</span> <span class="pre">gpg</span> <span class="pre">init</span></code><a class="headerlink" href="#spack-gpg-init" title="Link to this heading"></a></h3>
<p>When Spack is first installed, its keyring is empty. Keys stored in
<code class="file docutils literal notranslate"><span class="pre">var/spack/gpg</span></code> are the default keys for a Spack installation. These
keys may be imported by running <code class="docutils literal notranslate"><span class="pre">spack</span> <span class="pre">gpg</span> <span class="pre">init</span></code>. This will import the
default keys into the keyring as trusted keys.</p>
</section>
<section id="trusting-keys">
<h3>Trusting keys<a class="headerlink" href="#trusting-keys" title="Link to this heading"></a></h3>
<p>Additional keys may be added to the keyring using
<code class="docutils literal notranslate"><span class="pre">spack</span> <span class="pre">gpg</span> <span class="pre">trust</span> <span class="pre">&lt;keyfile&gt;</span></code>. Once a key is trusted, packages signed by the
owner of they key may be installed.</p>
</section>
<section id="creating-keys">
<h3>Creating keys<a class="headerlink" href="#creating-keys" title="Link to this heading"></a></h3>
<p>You may also create your own key so that you may sign your own packages using
<code class="docutils literal notranslate"><span class="pre">spack</span> <span class="pre">gpg</span> <span class="pre">create</span> <span class="pre">&lt;name&gt;</span> <span class="pre">&lt;email&gt;</span></code>. By default, the key has no expiration,
but it may be set with the <code class="docutils literal notranslate"><span class="pre">--expires</span> <span class="pre">&lt;date&gt;</span></code> flag (see the <code class="docutils literal notranslate"><span class="pre">gnupg2</span></code>
documentation for accepted date formats). It is also recommended to add a
comment as to the use of the key using the <code class="docutils literal notranslate"><span class="pre">--comment</span> <span class="pre">&lt;comment&gt;</span></code> flag. The
public half of the key can also be exported for sharing with others so that
they may use packages you have signed using the <code class="docutils literal notranslate"><span class="pre">--export</span> <span class="pre">&lt;keyfile&gt;</span></code> flag.
Secret keys may also be later exported using the
<code class="docutils literal notranslate"><span class="pre">spack</span> <span class="pre">gpg</span> <span class="pre">export</span> <span class="pre">&lt;location&gt;</span> <span class="pre">[&lt;key&gt;...]</span></code> command.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<dl>
<dt>Key creation speed</dt><dd><p>The creation of a new GPG key requires generating a lot of random numbers.
Depending on the entropy produced on your system, the entire process may
take a long time (<em>even appearing to hang</em>). Virtual machines and cloud
instances are particularly likely to display this behavior.</p>
<p>To speed it up you may install tools like <code class="docutils literal notranslate"><span class="pre">rngd</span></code>, which is
usually available as a package in the host OS.  On e.g. an
Ubuntu machine you need to give the following commands:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>sudo<span class="w"> </span>apt-get<span class="w"> </span>install<span class="w"> </span>rng-tools
<span class="gp">$ </span>sudo<span class="w"> </span>rngd<span class="w"> </span>-r<span class="w"> </span>/dev/urandom
</pre></div>
</div>
<p>before generating the keys.</p>
<p>Another alternative is <code class="docutils literal notranslate"><span class="pre">haveged</span></code>, which can be installed on
RHEL/CentOS machines as follows:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>sudo<span class="w"> </span>yum<span class="w"> </span>install<span class="w"> </span>haveged
<span class="gp">$ </span>sudo<span class="w"> </span>chkconfig<span class="w"> </span>haveged<span class="w"> </span>on
</pre></div>
</div>
<p><a class="reference external" href="https://www.digitalocean.com/community/tutorials/how-to-setup-additional-entropy-for-cloud-servers-using-haveged">This Digital Ocean tutorial</a>
provides a good overview of sources of randomness.</p>
</dd>
</dl>
</div>
<p>Here is an example of creating a key. Note that we provide a name for the key first
(which we can use to reference the key later) and an email address:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>spack<span class="w"> </span>gpg<span class="w"> </span>create<span class="w"> </span>dinosaur<span class="w"> </span>dinosaur@thedinosaurthings.com
</pre></div>
</div>
<p>If you want to export the key as you create it:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>spack<span class="w"> </span>gpg<span class="w"> </span>create<span class="w"> </span>--export<span class="w"> </span>key.pub<span class="w"> </span>dinosaur<span class="w"> </span>dinosaur@thedinosaurthings.com
</pre></div>
</div>
<p>Or the private key:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>spack<span class="w"> </span>gpg<span class="w"> </span>create<span class="w"> </span>--export-secret<span class="w"> </span>key.priv<span class="w"> </span>dinosaur<span class="w"> </span>dinosaur@thedinosaurthings.com
</pre></div>
</div>
<p>You can include both <code class="docutils literal notranslate"><span class="pre">--export</span></code> and <code class="docutils literal notranslate"><span class="pre">--export-secret</span></code>, each with
an output file of choice, to export both.</p>
</section>
<section id="listing-keys">
<h3>Listing keys<a class="headerlink" href="#listing-keys" title="Link to this heading"></a></h3>
<p>In order to list the keys available in the keyring, the
<code class="docutils literal notranslate"><span class="pre">spack</span> <span class="pre">gpg</span> <span class="pre">list</span></code> command will list trusted keys with the <code class="docutils literal notranslate"><span class="pre">--trusted</span></code> flag
and keys available for signing using <code class="docutils literal notranslate"><span class="pre">--signing</span></code>. If you would like to
remove keys from your keyring, <code class="docutils literal notranslate"><span class="pre">spack</span> <span class="pre">gpg</span> <span class="pre">untrust</span> <span class="pre">&lt;keyid&gt;</span></code>. Key IDs can be
email addresses, names, or (best) fingerprints. Here is an example of listing
the key that we just created:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">gpgconf: socketdir is &#39;/run/user/1000/gnupg&#39;</span>
<span class="go">/home/spackuser/spack/opt/spack/gpg/pubring.kbx</span>
<span class="go">----------------------------------------------------------</span>
<span class="go">pub   rsa4096 2021-03-25 [SC]</span>
<span class="go">      60D2685DAB647AD4DB54125961E09BB6F2A0ADCB</span>
<span class="go">uid           [ultimate] dinosaur (GPG created for Spack) &lt;dinosaur@thedinosaurthings.com&gt;</span>
</pre></div>
</div>
<p>Note that the name “dinosaur” can be seen under the uid, which is the unique
id. We might need this reference if we want to export or otherwise reference the key.</p>
</section>
<section id="signing-and-verifying-packages">
<h3>Signing and Verifying Packages<a class="headerlink" href="#signing-and-verifying-packages" title="Link to this heading"></a></h3>
<p>In order to sign a package, <code class="docutils literal notranslate"><span class="pre">spack</span> <span class="pre">gpg</span> <span class="pre">sign</span> <span class="pre">&lt;file&gt;</span></code> should be used. By
default, the signature will be written to <code class="docutils literal notranslate"><span class="pre">&lt;file&gt;.asc</span></code>, but that may be
changed by using the <code class="docutils literal notranslate"><span class="pre">--output</span> <span class="pre">&lt;file&gt;</span></code> flag. If there is only one signing
key available, it will be used, but if there is more than one, the key to use
must be specified using the <code class="docutils literal notranslate"><span class="pre">--key</span> <span class="pre">&lt;keyid&gt;</span></code> flag. The <code class="docutils literal notranslate"><span class="pre">--clearsign</span></code> flag
may also be used to create a signed file which contains the contents, but it
is not recommended. Signed packages may be verified by using
<code class="docutils literal notranslate"><span class="pre">spack</span> <span class="pre">gpg</span> <span class="pre">verify</span> <span class="pre">&lt;file&gt;</span></code>.</p>
</section>
<section id="exporting-keys">
<h3>Exporting Keys<a class="headerlink" href="#exporting-keys" title="Link to this heading"></a></h3>
<p>You likely might want to export a public key, and that looks like this. Let’s
use the previous example and ask spack to export the key with uid “dinosaur.”
We will provide an output location (typically a <cite>*.pub</cite> file) and the name of
the key.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>spack<span class="w"> </span>gpg<span class="w"> </span><span class="nb">export</span><span class="w"> </span>dinosaur.pub<span class="w"> </span>dinosaur
</pre></div>
</div>
<p>You can then look at the created file, <cite>dinosaur.pub</cite>, to see the exported key.
If you want to include the private key, then just add <cite>–secret</cite>:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>spack<span class="w"> </span>gpg<span class="w"> </span><span class="nb">export</span><span class="w"> </span>--secret<span class="w"> </span>dinosaur.priv<span class="w"> </span>dinosaur
</pre></div>
</div>
<p>This will write the private key to the file <cite>dinosaur.priv</cite>.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>You should be very careful about exporting private keys. You likely would
only want to do this in the context of moving your spack installation to
a different server, and wanting to preserve keys for a buildcache. If you
are unsure about exporting, you can ask your local system administrator
or for help on an issue or the Spack slack.</p>
</div>
</section>
</section>
<section id="spack-on-windows">
<span id="windows-support"></span><h2>Spack On Windows<a class="headerlink" href="#spack-on-windows" title="Link to this heading"></a></h2>
<p>Windows support for Spack is currently under development. While this work is still in an early stage,
it is currently possible to set up Spack and perform a few operations on Windows.  This section will guide
you through the steps needed to install Spack and start running it on a fresh Windows machine.</p>
<section id="step-1-install-prerequisites">
<h3>Step 1: Install prerequisites<a class="headerlink" href="#step-1-install-prerequisites" title="Link to this heading"></a></h3>
<p>To use Spack on Windows, you will need the following packages:</p>
<p>Required:
* Microsoft Visual Studio
* Python
* Git</p>
<p>Optional:
* Intel Fortran (needed for some packages)</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Currently MSVC is the only compiler tested for C/C++ projects. Intel OneAPI provides Fortran support.</p>
</div>
<section id="microsoft-visual-studio">
<h4>Microsoft Visual Studio<a class="headerlink" href="#microsoft-visual-studio" title="Link to this heading"></a></h4>
<p>Microsoft Visual Studio provides the only Windows C/C++ compiler that is currently supported by Spack.
Spack additionally requires that the Windows SDK (including WGL) to be installed as part of your
visual studio installation as it is required to build many packages from source.</p>
<p>We require several specific components to be included in the Visual Studio installation.
One is the C/C++ toolset, which can be selected as “Desktop development with C++” or “C++ build tools,”
depending on installation type (Professional, Build Tools, etc.)  The other required component is
“C++ CMake tools for Windows,” which can be selected from among the optional packages.
This provides CMake and Ninja for use during Spack configuration.</p>
<p>If you already have Visual Studio installed, you can make sure these components are installed by
rerunning the installer.  Next to your installation, select “Modify” and look at the
“Installation details” pane on the right.</p>
</section>
<section id="intel-fortran">
<h4>Intel Fortran<a class="headerlink" href="#intel-fortran" title="Link to this heading"></a></h4>
<p>For Fortran-based packages on Windows, we strongly recommend Intel’s oneAPI Fortran compilers.
The suite is free to download from Intel’s website, located at
<a class="reference external" href="https://software.intel.com/content/www/us/en/develop/tools/oneapi/components/fortran-compiler.html">https://software.intel.com/content/www/us/en/develop/tools/oneapi/components/fortran-compiler.html</a>.
The executable of choice for Spack will be Intel’s Beta Compiler, ifx, which supports the classic
compiler’s (ifort’s) frontend and runtime libraries by using LLVM.</p>
</section>
<section id="python">
<h4>Python<a class="headerlink" href="#python" title="Link to this heading"></a></h4>
<p>As Spack is a Python-based package, an installation of Python will be needed to run it.
Python 3 can be downloaded and installed from the Windows Store, and will be automatically added
to your <code class="docutils literal notranslate"><span class="pre">PATH</span></code> in this case.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Spack currently supports Python versions later than 3.2 inclusive.</p>
</div>
</section>
<section id="id7">
<h4>Git<a class="headerlink" href="#id7" title="Link to this heading"></a></h4>
<p>A bash console and GUI can be downloaded from <a class="reference external" href="https://git-scm.com/downloads">https://git-scm.com/downloads</a>.
If you are unfamiliar with Git, there are a myriad of resources online to help
guide you through checking out repositories and switching development branches.</p>
<p>When given the option of adjusting your <code class="docutils literal notranslate"><span class="pre">PATH</span></code>, choose the <code class="docutils literal notranslate"><span class="pre">Git</span> <span class="pre">from</span> <span class="pre">the</span>
<span class="pre">command</span> <span class="pre">line</span> <span class="pre">and</span> <span class="pre">also</span> <span class="pre">from</span> <span class="pre">3rd-party</span> <span class="pre">software</span></code> option. This will automatically
update your <code class="docutils literal notranslate"><span class="pre">PATH</span></code> variable to include the <code class="docutils literal notranslate"><span class="pre">git</span></code> command.</p>
<p>Spack support on Windows is currently dependent on installing the Git for Windows project
as the project providing Git support on Windows. This is additionally the recommended method
for installing Git on Windows, a link to which can be found above. Spack requires the
utilities vendored by this project.</p>
</section>
<p>utilities vendored by this project.</p>
</section>
<section id="step-2-install-and-setup-spack">
<h3>Step 2: Install and setup Spack<a class="headerlink" href="#step-2-install-and-setup-spack" title="Link to this heading"></a></h3>
<p>We are now ready to get the Spack environment set up on our machine. We
begin by using Git to clone the Spack repo, hosted at <a class="reference external" href="https://github.com/spack/spack.git">https://github.com/spack/spack.git</a>
into a desired directory, for our purposes today, called <code class="docutils literal notranslate"><span class="pre">spack_install</span></code>.</p>
<p>In order to install Spack with Windows support, run the following one liner
in a Windows CMD prompt.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">git clone https://github.com/spack/spack.git</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If you chose to install Spack into a directory on Windows that is set up to require Administrative
Privileges, Spack will require elevated privileges to run.
Administrative Privileges can be denoted either by default such as
<code class="docutils literal notranslate"><span class="pre">C:\Program</span> <span class="pre">Files</span></code>, or aministrator applied administrative restrictions
on a directory that spack installs files to such as <code class="docutils literal notranslate"><span class="pre">C:\Users</span></code></p>
</div>
</section>
<section id="step-3-run-and-configure-spack">
<h3>Step 3: Run and configure Spack<a class="headerlink" href="#step-3-run-and-configure-spack" title="Link to this heading"></a></h3>
<p>On Windows, Spack supports both primary native shells, Powershell and the traditional command prompt.
To use Spack, pick your favorite shell, and run <code class="docutils literal notranslate"><span class="pre">bin\spack_cmd.bat</span></code> or <code class="docutils literal notranslate"><span class="pre">share/spack/setup-env.ps1</span></code>
(you may need to Run as Administrator) from the top-level spack
directory. This will provide a Spack enabled shell. If you receive a warning message that Python is not in your <code class="docutils literal notranslate"><span class="pre">PATH</span></code>
(which may happen if you installed Python from the website and not the Windows Store) add the location
of the Python executable to your <code class="docutils literal notranslate"><span class="pre">PATH</span></code> now. You can permanently add Python to your <code class="docutils literal notranslate"><span class="pre">PATH</span></code> variable
by using the <code class="docutils literal notranslate"><span class="pre">Edit</span> <span class="pre">the</span> <span class="pre">system</span> <span class="pre">environment</span> <span class="pre">variables</span></code> utility in Windows Control Panel.</p>
<p>To configure Spack, first run the following command inside the Spack console:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">spack compiler find</span>
</pre></div>
</div>
<p>This creates a <code class="docutils literal notranslate"><span class="pre">.staging</span></code> directory in our Spack prefix, along with a <code class="docutils literal notranslate"><span class="pre">windows</span></code> subdirectory
containing a <code class="docutils literal notranslate"><span class="pre">compilers.yaml</span></code> file. On a fresh Windows install with the above packages
installed, this command should only detect Microsoft Visual Studio and the Intel Fortran
compiler will be integrated within the first version of MSVC present in the <code class="docutils literal notranslate"><span class="pre">compilers.yaml</span></code>
output.</p>
<p>Spack provides a default <code class="docutils literal notranslate"><span class="pre">config.yaml</span></code> file for Windows that it will use unless overridden.
This file is located at <code class="docutils literal notranslate"><span class="pre">etc\spack\defaults\windows\config.yaml</span></code>. You can read more on how to
do this and write your own configuration files in the <a class="reference internal" href="configuration.html#configuration"><span class="std std-ref">Configuration Files</span></a> section of our
documentation. If you do this, pay particular attention to the <code class="docutils literal notranslate"><span class="pre">build_stage</span></code> block of the file
as this specifies the directory that will temporarily hold the source code for the packages to
be installed. This path name must be sufficiently short for compliance with cmd, otherwise you
will see build errors during installation (particularly with CMake) tied to long path names.</p>
<p>To allow Spack use of external tools and dependencies already on your system, the
external pieces of software must be described in the <code class="docutils literal notranslate"><span class="pre">packages.yaml</span></code> file.
There are two methods to populate this file:</p>
<p>The first and easiest choice is to use Spack to find installation on your system. In
the Spack terminal, run the following commands:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">spack external find cmake</span>
<span class="go">spack external find ninja</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">spack</span> <span class="pre">external</span> <span class="pre">find</span> <span class="pre">&lt;name&gt;</span></code> will find executables on your system
with the same name given. The command will store the items found in
<code class="docutils literal notranslate"><span class="pre">packages.yaml</span></code> in the <code class="docutils literal notranslate"><span class="pre">.staging\</span></code> directory.</p>
<p>Assuming that the command found CMake and Ninja executables in the previous
step, continue to Step 4. If no executables were found, we may need to manually direct spack towards the CMake
and Ninja installations we set up with Visual Studio. Therefore, your <code class="docutils literal notranslate"><span class="pre">packages.yaml</span></code> file will look something
like this, with possibly slight variants in the paths to CMake and Ninja:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">packages</span><span class="p">:</span>
<span class="w">  </span><span class="nt">cmake</span><span class="p">:</span>
<span class="w">    </span><span class="nt">externals</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">spec</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">cmake@3.19</span>
<span class="w">      </span><span class="nt">prefix</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;c:\Program</span><span class="nv"> </span><span class="s">Files</span><span class="nv"> </span><span class="s">(x86)\Microsoft</span><span class="nv"> </span><span class="s">Visual</span><span class="nv"> </span><span class="s">Studio\2019\Professional\Common7\IDE\CommonExtensions\Microsoft\CMake\CMake&#39;</span>
<span class="w">    </span><span class="nt">buildable</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">False</span>
<span class="w">  </span><span class="nt">ninja</span><span class="p">:</span>
<span class="w">    </span><span class="nt">externals</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">spec</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ninja@1.8.2</span>
<span class="w">      </span><span class="nt">prefix</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;c:\Program</span><span class="nv"> </span><span class="s">Files</span><span class="nv"> </span><span class="s">(x86)\Microsoft</span><span class="nv"> </span><span class="s">Visual</span><span class="nv"> </span><span class="s">Studio\2019\Professional\Common7\IDE\CommonExtensions\Microsoft\CMake\Ninja&#39;</span>
<span class="w">    </span><span class="nt">buildable</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">False</span>
</pre></div>
</div>
<p>You can also use an separate installation of CMake if you have one and prefer
to use it. If you don’t have a path to Ninja analogous to the above, then you can
obtain it by running the Visual Studio Installer and following the instructions
at the start of this section. Also note that .yaml files use spaces for indentation
and not tabs, so ensure that this is the case when editing one directly.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Cygwin
The use of Cygwin is not officially supported by Spack and is not tested.
However Spack will not prevent this, so use if choosing to use Spack
with Cygwin, know that no functionality is garunteed.</p>
</div>
</section>
<section id="step-4-use-spack">
<h3>Step 4: Use Spack<a class="headerlink" href="#step-4-use-spack" title="Link to this heading"></a></h3>
<p>Once the configuration is complete, it is time to give the installation a test.  Install a basic package though the
Spack console via:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">spack install cpuinfo</span>
</pre></div>
</div>
<p>If in the previous step, you did not have CMake or Ninja installed, running the command above should install both packages</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Spec Syntax Caveats
Windows has a few idiosyncrasies when it comes to the Spack spec syntax and the use of certain shells
See the Spack spec syntax doc for more information</p>
</div>
</section>
<section id="for-developers">
<h3>For developers<a class="headerlink" href="#for-developers" title="Link to this heading"></a></h3>
<p>The intent is to provide a Windows installer that will automatically set up
Python, Git, and Spack, instead of requiring the user to do so manually.
Instructions for creating the installer are at
<a class="reference external" href="https://github.com/spack/spack/blob/develop/lib/spack/spack/cmd/installer/README.md">https://github.com/spack/spack/blob/develop/lib/spack/spack/cmd/installer/README.md</a></p>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="features.html" class="btn btn-neutral float-left" title="Feature Overview" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="basic_usage.html" class="btn btn-neutral float-right" title="Basic Usage" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2013-2023, Lawrence Livermore National Laboratory..
      <span class="lastupdated">Last updated on Sep 20, 2025.
      </span></p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>