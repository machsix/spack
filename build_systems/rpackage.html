

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>R &mdash; Spack 0.23.1 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=5f00b823" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../_static/graphviz.css?v=4ae1632d" />
      <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />

  
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
      <script src="../_static/jquery.js?v=5d32c60e"></script>
      <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../_static/documentation_options.js?v=832b3b9f"></script>
      <script src="../_static/doctools.js?v=9bcbadda"></script>
      <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Racket" href="racketpackage.html" />
    <link rel="prev" title="Python" href="pythonpackage.html" /> 
  <!-- Google tag (gtag.js) -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-S0PQ7WV75K"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-S0PQ7WV75K');
  </script>

</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html">
            
              <img src="../_static/spack-logo-white-text.svg" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Basics</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../features.html">Feature Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../getting_started.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../basic_usage.html">Basic Usage</a></li>
<li class="toctree-l1"><a class="reference internal" href="../replace_conda_homebrew.html">Spack for Homebrew/Conda Users</a></li>
<li class="toctree-l1"><a class="reference internal" href="../frequently_asked_questions.html">Frequently Asked Questions</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Links</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://spack-tutorial.readthedocs.io">Tutorial (spack-tutorial.rtfd.io)</a></li>
<li class="toctree-l1"><a class="reference external" href="https://packages.spack.io">Packages (packages.spack.io)</a></li>
<li class="toctree-l1"><a class="reference external" href="https://cache.spack.io">Binaries (binaries.spack.io)</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../configuration.html">Configuration Files</a></li>
<li class="toctree-l1"><a class="reference internal" href="../config_yaml.html">Spack Settings (config.yaml)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../packages_yaml.html">Package Settings (packages.yaml)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../build_settings.html">Concretization Settings (concretizer.yaml)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../environments.html">Environments (spack.yaml, spack.lock)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../containers.html">Container Images</a></li>
<li class="toctree-l1"><a class="reference internal" href="../mirrors.html">Mirrors (mirrors.yaml)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../module_file_support.html">Modules (modules.yaml)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../repositories.html">Package Repositories (repos.yaml)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../binary_caches.html">Build Caches</a></li>
<li class="toctree-l1"><a class="reference internal" href="../bootstrapping.html">Bootstrapping</a></li>
<li class="toctree-l1"><a class="reference internal" href="../command_index.html">Command Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../chain.html">Chaining Spack Installations (upstreams.yaml)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../extensions.html">Custom Extensions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pipelines.html">CI Pipelines</a></li>
<li class="toctree-l1"><a class="reference internal" href="../signing.html">Spack Package Signing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../gpu_configuration.html">Using External GPU Support</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Contributing</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../contribution_guide.html">Contribution Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../packaging_guide.html">Packaging Guide</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../build_systems.html">Build Systems</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="makefilepackage.html">Makefile</a></li>
<li class="toctree-l2"><a class="reference internal" href="mavenpackage.html">Maven</a></li>
<li class="toctree-l2"><a class="reference internal" href="sconspackage.html">SCons</a></li>
<li class="toctree-l2"><a class="reference internal" href="wafpackage.html">Waf</a></li>
<li class="toctree-l2"><a class="reference internal" href="autotoolspackage.html">Autotools</a></li>
<li class="toctree-l2"><a class="reference internal" href="cmakepackage.html">CMake</a></li>
<li class="toctree-l2"><a class="reference internal" href="cachedcmakepackage.html">CachedCMake</a></li>
<li class="toctree-l2"><a class="reference internal" href="mesonpackage.html">Meson</a></li>
<li class="toctree-l2"><a class="reference internal" href="qmakepackage.html">QMake</a></li>
<li class="toctree-l2"><a class="reference internal" href="sippackage.html">SIP</a></li>
<li class="toctree-l2"><a class="reference internal" href="luapackage.html">Lua</a></li>
<li class="toctree-l2"><a class="reference internal" href="octavepackage.html">Octave</a></li>
<li class="toctree-l2"><a class="reference internal" href="perlpackage.html">Perl</a></li>
<li class="toctree-l2"><a class="reference internal" href="pythonpackage.html">Python</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">R</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#phases">Phases</a></li>
<li class="toctree-l3"><a class="reference internal" href="#finding-r-packages">Finding R packages</a></li>
<li class="toctree-l3"><a class="reference internal" href="#package-name">Package name</a></li>
<li class="toctree-l3"><a class="reference internal" href="#description">Description</a></li>
<li class="toctree-l3"><a class="reference internal" href="#homepage">Homepage</a></li>
<li class="toctree-l3"><a class="reference internal" href="#url">URL</a></li>
<li class="toctree-l3"><a class="reference internal" href="#list-url">List URL</a></li>
<li class="toctree-l3"><a class="reference internal" href="#bioconductor-packages">Bioconductor packages</a></li>
<li class="toctree-l3"><a class="reference internal" href="#cran-and-bioc-attributes">cran and bioc attributes</a></li>
<li class="toctree-l3"><a class="reference internal" href="#build-system-dependencies">Build system dependencies</a></li>
<li class="toctree-l3"><a class="reference internal" href="#r-dependencies">R dependencies</a></li>
<li class="toctree-l3"><a class="reference internal" href="#core-recommended-and-non-core-packages">Core, recommended, and non-core packages</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#core-packages">Core packages</a></li>
<li class="toctree-l4"><a class="reference internal" href="#recommended-packages">Recommended packages</a></li>
<li class="toctree-l4"><a class="reference internal" href="#non-core-packages">Non-core packages</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#non-r-dependencies">Non-R dependencies</a></li>
<li class="toctree-l3"><a class="reference internal" href="#passing-arguments-to-the-installation">Passing arguments to the installation</a></li>
<li class="toctree-l3"><a class="reference internal" href="#alternatives-to-spack">Alternatives to Spack</a></li>
<li class="toctree-l3"><a class="reference internal" href="#external-documentation">External documentation</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="racketpackage.html">Racket</a></li>
<li class="toctree-l2"><a class="reference internal" href="rubypackage.html">Ruby</a></li>
<li class="toctree-l2"><a class="reference internal" href="bundlepackage.html">Bundle</a></li>
<li class="toctree-l2"><a class="reference internal" href="cudapackage.html">Cuda</a></li>
<li class="toctree-l2"><a class="reference internal" href="custompackage.html">Custom Build Systems</a></li>
<li class="toctree-l2"><a class="reference internal" href="inteloneapipackage.html">IntelOneapi</a></li>
<li class="toctree-l2"><a class="reference internal" href="intelpackage.html">Intel</a></li>
<li class="toctree-l2"><a class="reference internal" href="rocmpackage.html">ROCm</a></li>
<li class="toctree-l2"><a class="reference internal" href="sourceforgepackage.html">Sourceforge</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../developer_guide.html">Developer Guide</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API Docs</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../spack.html">Spack API Docs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../llnl.html">LLNL API Docs</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Spack</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../build_systems.html">Build Systems</a></li>
      <li class="breadcrumb-item active">R</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/build_systems/rpackage.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="r">
<span id="rpackage"></span><h1>R<a class="headerlink" href="#r" title="Link to this heading"></a></h1>
<p>Like Python, R has its own built-in build system.</p>
<p>The R build system is remarkably uniform and well-tested.
This makes it one of the easiest build systems to create
new Spack packages for.</p>
<section id="phases">
<h2>Phases<a class="headerlink" href="#phases" title="Link to this heading"></a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">RBuilder</span></code> and <code class="docutils literal notranslate"><span class="pre">RPackage</span></code> base classes have a single phase:</p>
<ol class="arabic simple">
<li><p><code class="docutils literal notranslate"><span class="pre">install</span></code> - install the package</p></li>
</ol>
<p>By default, this phase runs the following command:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>R<span class="w"> </span>CMD<span class="w"> </span>INSTALL<span class="w"> </span>--library<span class="o">=</span>/path/to/installation/prefix/rlib/R/library<span class="w"> </span>.
</pre></div>
</div>
</section>
<section id="finding-r-packages">
<h2>Finding R packages<a class="headerlink" href="#finding-r-packages" title="Link to this heading"></a></h2>
<p>The vast majority of R packages are hosted on CRAN - The Comprehensive
R Archive Network. If you are looking for a particular R package, search
for “CRAN &lt;package-name&gt;” and you should quickly find what you want.
If it isn’t on CRAN, try Bioconductor, another common R repository.</p>
<p>For the purposes of this tutorial, we will be walking through
<a class="reference external" href="https://github.com/spack/spack/blob/develop/var/spack/repos/builtin/packages/r-caret/package.py">r-caret</a>
as an example. If you search for “CRAN caret”, you will quickly find what
you are looking for at <a class="reference external" href="https://cran.r-project.org/package=caret">https://cran.r-project.org/package=caret</a>.
<a class="reference external" href="https://cran.r-project.org">https://cran.r-project.org</a> is the main CRAN website. However, CRAN also
has a <a class="reference external" href="https://cloud.r-project.org">https://cloud.r-project.org</a> site that automatically redirects to
<a class="reference external" href="https://cloud.r-project.org/mirrors.html">mirrors around the world</a>.
For stability and performance reasons, we will use <a class="reference external" href="https://cloud.r-project.org/package=caret">https://cloud.r-project.org/package=caret</a>.
If you search for “Package source”, you will find the download URL for
the latest release. Use this URL with <code class="docutils literal notranslate"><span class="pre">spack</span> <span class="pre">create</span></code> to create a new
package.</p>
</section>
<section id="package-name">
<h2>Package name<a class="headerlink" href="#package-name" title="Link to this heading"></a></h2>
<p>The first thing you’ll notice is that Spack prepends <code class="docutils literal notranslate"><span class="pre">r-</span></code> to the front
of the package name. This is how Spack separates R package extensions
from the rest of the packages in Spack. Without this, we would end up
with package name collisions more frequently than we would like. For
instance, there are already packages for both:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">ape</span></code> and <code class="docutils literal notranslate"><span class="pre">r-ape</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">curl</span></code> and <code class="docutils literal notranslate"><span class="pre">r-curl</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">gmp</span></code> and <code class="docutils literal notranslate"><span class="pre">r-gmp</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">jpeg</span></code> and <code class="docutils literal notranslate"><span class="pre">r-jpeg</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">openssl</span></code> and <code class="docutils literal notranslate"><span class="pre">r-openssl</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">uuid</span></code> and <code class="docutils literal notranslate"><span class="pre">r-uuid</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">xts</span></code> and <code class="docutils literal notranslate"><span class="pre">r-xts</span></code></p></li>
</ul>
<p>Many popular programs written in C/C++ are later ported to R as a
separate project.</p>
</section>
<section id="description">
<h2>Description<a class="headerlink" href="#description" title="Link to this heading"></a></h2>
<p>The first thing you’ll need to add to your new package is a description.
The top of the homepage for <code class="docutils literal notranslate"><span class="pre">caret</span></code> lists the following description:</p>
<blockquote>
<div><p>Classification and Regression Training</p>
<p>Misc functions for training and plotting classification and regression models.</p>
</div></blockquote>
<p>The first line is a short description (title) and the second line is a long
description. In this case the description is only one line but often the
description is several lines. Spack makes use of both short and long
descriptions and convention is to use both when creating an R  package.</p>
</section>
<section id="homepage">
<h2>Homepage<a class="headerlink" href="#homepage" title="Link to this heading"></a></h2>
<p>If you look at the bottom of the page, you’ll see:</p>
<blockquote>
<div><p>Linking:</p>
<p>Please use the canonical form <a class="reference external" href="https://CRAN.R-project.org/package=caret">https://CRAN.R-project.org/package=caret</a> to link to this page.</p>
</div></blockquote>
<p>Please uphold the wishes of the CRAN admins and use
<a class="reference external" href="https://cloud.r-project.org/package=caret">https://cloud.r-project.org/package=caret</a> as the homepage instead of
<a class="reference external" href="https://cloud.r-project.org/web/packages/caret/index.html">https://cloud.r-project.org/web/packages/caret/index.html</a>. The latter may
change without notice.</p>
</section>
<section id="url">
<h2>URL<a class="headerlink" href="#url" title="Link to this heading"></a></h2>
<p>As previously mentioned, the download URL for the latest release can be
found by searching “Package source” on the homepage.</p>
</section>
<section id="list-url">
<h2>List URL<a class="headerlink" href="#list-url" title="Link to this heading"></a></h2>
<p>CRAN maintains a single webpage containing the latest release of every
single package: <a class="reference external" href="https://cloud.r-project.org/src/contrib/">https://cloud.r-project.org/src/contrib/</a></p>
<p>Of course, as soon as a new release comes out, the version you were using
in your package is no longer available at that URL. It is moved to an
archive directory. If you search for “Old sources”, you will find:
<a class="reference external" href="https://cloud.r-project.org/src/contrib/Archive/caret">https://cloud.r-project.org/src/contrib/Archive/caret</a></p>
<p>If you only specify the URL for the latest release, your package will
no longer be able to fetch that version as soon as a new release comes
out. To get around this, add the archive directory as a <code class="docutils literal notranslate"><span class="pre">list_url</span></code>.</p>
</section>
<section id="bioconductor-packages">
<h2>Bioconductor packages<a class="headerlink" href="#bioconductor-packages" title="Link to this heading"></a></h2>
<p>Bioconductor packages are set up in a similar way to CRAN packages, but there
are some very important distinctions. Bioconductor packages can be found at:
<a class="reference external" href="https://bioconductor.org/">https://bioconductor.org/</a>. Bioconductor packages are R packages and so follow
the same packaging scheme as CRAN packages. What is different is that
Bioconductor itself is versioned and released. This scheme, using the
Bioconductor package installer, allows further specification of the minimum
version of R as well as further restrictions on the dependencies between
packages than what is possible with the native R packaging system. Spack can
not replicate these extra features and thus Bioconductor packages in Spack need
to be managed as a group during updates in order to maintain package
consistency with Bioconductor itself.</p>
<p>Another key difference is that, while previous versions of packages are
available, they are not available from a site that can be programmatically set,
thus a <code class="docutils literal notranslate"><span class="pre">list_url</span></code> attribute can not be used. However, each package is also
available in a git repository, with branches corresponding to each Bioconductor
release. Thus, it is always possible to retrieve the version of any package
corresponding to a Bioconductor release simply by fetching the branch that
corresponds to the Bioconductor release of the package repository. For this
reason, spack Bioconductor R packages use the git repository, with the commit
of the respective branch used in the <code class="docutils literal notranslate"><span class="pre">version()</span></code> attribute of the package.</p>
</section>
<section id="cran-and-bioc-attributes">
<h2>cran and bioc attributes<a class="headerlink" href="#cran-and-bioc-attributes" title="Link to this heading"></a></h2>
<p>Much like the <code class="docutils literal notranslate"><span class="pre">pypi</span></code> attribute for python packages, due to the fact that R
packages are obtained from specific repositories, it is possible to set up shortcut
attributes that can be used to set <code class="docutils literal notranslate"><span class="pre">homepage</span></code>, <code class="docutils literal notranslate"><span class="pre">url</span></code>, <code class="docutils literal notranslate"><span class="pre">list_url</span></code>, and
<code class="docutils literal notranslate"><span class="pre">git</span></code>. For example, the following <code class="docutils literal notranslate"><span class="pre">cran</span></code> attribute:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">cran</span> <span class="o">=</span> <span class="s2">&quot;caret&quot;</span>
</pre></div>
</div>
<p>is equivalent to:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">homepage</span> <span class="o">=</span> <span class="s2">&quot;https://cloud.r-project.org/package=caret&quot;</span>
<span class="n">url</span>      <span class="o">=</span> <span class="s2">&quot;https://cloud.r-project.org/src/contrib/caret_6.0-86.tar.gz&quot;</span>
<span class="n">list_url</span> <span class="o">=</span> <span class="s2">&quot;https://cloud.r-project.org/src/contrib/Archive/caret&quot;</span>
</pre></div>
</div>
<p>Likewise, the following <code class="docutils literal notranslate"><span class="pre">bioc</span></code> attribute:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">bioc</span> <span class="o">=</span> <span class="s2">&quot;BiocVersion&quot;</span>
</pre></div>
</div>
<p>is equivalent to:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">homepage</span> <span class="o">=</span> <span class="s2">&quot;https://bioconductor.org/packages/BiocVersion/&quot;</span>
<span class="n">git</span>      <span class="o">=</span> <span class="s2">&quot;https://git.bioconductor.org/packages/BiocVersion&quot;</span>
</pre></div>
</div>
</section>
<section id="build-system-dependencies">
<h2>Build system dependencies<a class="headerlink" href="#build-system-dependencies" title="Link to this heading"></a></h2>
<p>As an extension of the R ecosystem, your package will obviously depend
on R to build and run. Normally, we would use <code class="docutils literal notranslate"><span class="pre">depends_on</span></code> to express
this, but for R packages, we use <code class="docutils literal notranslate"><span class="pre">extends</span></code>. This implies a special
dependency on R, which is used to set environment variables such as
<code class="docutils literal notranslate"><span class="pre">R_LIBS</span></code> uniformly. Since every R package needs this, the <code class="docutils literal notranslate"><span class="pre">RPackage</span></code>
base class contains:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">extends</span><span class="p">(</span><span class="s2">&quot;r&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Take a close look at the homepage for <code class="docutils literal notranslate"><span class="pre">caret</span></code>. If you look at the
“Depends” section, you’ll notice that <code class="docutils literal notranslate"><span class="pre">caret</span></code> depends on “R (≥ 3.2.0)”.
You should add this to your package like so:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">depends_on</span><span class="p">(</span><span class="s2">&quot;r@3.2.0:&quot;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;build&quot;</span><span class="p">,</span> <span class="s2">&quot;run&quot;</span><span class="p">))</span>
</pre></div>
</div>
</section>
<section id="r-dependencies">
<h2>R dependencies<a class="headerlink" href="#r-dependencies" title="Link to this heading"></a></h2>
<p>R packages are often small and follow the classic Unix philosophy
of doing one thing well. They are modular and usually depend on
several other packages. You may find a single package with over a
hundred dependencies. Luckily, R packages are well-documented
and list all of their dependencies in the following sections:</p>
<ul class="simple">
<li><p>Depends</p></li>
<li><p>Imports</p></li>
<li><p>LinkingTo</p></li>
</ul>
<p>As far as Spack is concerned, all 3 of these dependency types
correspond to <code class="docutils literal notranslate"><span class="pre">type=(&quot;build&quot;,</span> <span class="pre">&quot;run&quot;)</span></code>, so you don’t have to worry
about the details. If you are curious what they mean,
<a class="reference external" href="https://github.com/spack/spack/issues/2951">https://github.com/spack/spack/issues/2951</a> has a pretty good summary:</p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">Depends</span></code> is required and will cause those R packages to be <em>attached</em>,
that is, their APIs are exposed to the user. <code class="docutils literal notranslate"><span class="pre">Imports</span></code> <em>loads</em> packages
so that <em>the package</em> importing these packages can access their APIs,
while <em>not</em> being exposed to the user. When a user calls <code class="docutils literal notranslate"><span class="pre">library(foo)</span></code>
s/he <em>attaches</em> package <code class="docutils literal notranslate"><span class="pre">foo</span></code> and all of the packages under <code class="docutils literal notranslate"><span class="pre">Depends</span></code>.
Any function in one of these package can be called directly as <code class="docutils literal notranslate"><span class="pre">bar()</span></code>.
If there are conflicts, user can also specify <code class="docutils literal notranslate"><span class="pre">pkgA::bar()</span></code> and
<code class="docutils literal notranslate"><span class="pre">pkgB::bar()</span></code> to distinguish between them. Historically, there was only
<code class="docutils literal notranslate"><span class="pre">Depends</span></code> and <code class="docutils literal notranslate"><span class="pre">Suggests</span></code>, hence the confusing names. Today, maybe
<code class="docutils literal notranslate"><span class="pre">Depends</span></code> would have been named <code class="docutils literal notranslate"><span class="pre">Attaches</span></code>.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">LinkingTo</span></code> is not perfect and there was recently an extensive
discussion about API/ABI among other things on the R-devel mailing
list among very skilled R developers:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://stat.ethz.ch/pipermail/r-devel/2016-December/073505.html">https://stat.ethz.ch/pipermail/r-devel/2016-December/073505.html</a></p></li>
<li><p><a class="reference external" href="https://stat.ethz.ch/pipermail/r-devel/2017-January/073647.html">https://stat.ethz.ch/pipermail/r-devel/2017-January/073647.html</a></p></li>
</ul>
</div></blockquote>
<p>Some packages also have a fourth section:</p>
<ul class="simple">
<li><p>Suggests</p></li>
</ul>
<p>These are optional, rarely-used dependencies that a user might find
useful. You should <strong>NOT</strong> add these dependencies to your package.
R packages already have enough dependencies as it is, and adding
optional dependencies can really slow down the concretization
process. They can also introduce circular dependencies.</p>
<p>A fifth rarely used section is:</p>
<ul class="simple">
<li><p>Enhances</p></li>
</ul>
<p>This means that the package can be used as an optional dependency
for another package. Again, these packages should <strong>NOT</strong> be listed
as dependencies.</p>
</section>
<section id="core-recommended-and-non-core-packages">
<h2>Core, recommended, and non-core packages<a class="headerlink" href="#core-recommended-and-non-core-packages" title="Link to this heading"></a></h2>
<p>If you look at “Depends”, “Imports”, and “LinkingTo”, you will notice
3 different types of packages:</p>
<section id="core-packages">
<h3>Core packages<a class="headerlink" href="#core-packages" title="Link to this heading"></a></h3>
<p>If you look at the <code class="docutils literal notranslate"><span class="pre">caret</span></code> homepage, you’ll notice a few dependencies
that don’t have a link to the package, like <code class="docutils literal notranslate"><span class="pre">methods</span></code>, <code class="docutils literal notranslate"><span class="pre">stats</span></code>, and
<code class="docutils literal notranslate"><span class="pre">utils</span></code>. These packages are part of the core R distribution and are
tied to the R version installed. You can basically consider these to be
“R itself”. These are so essential to R that it would not make sense for
them to be updated via CRAN. If you did, you would basically get a different
version of R. Thus, they’re updated when R is updated.</p>
<p>You can find a list of these core libraries at:
<a class="reference external" href="https://github.com/wch/r-source/tree/trunk/src/library">https://github.com/wch/r-source/tree/trunk/src/library</a></p>
</section>
<section id="recommended-packages">
<h3>Recommended packages<a class="headerlink" href="#recommended-packages" title="Link to this heading"></a></h3>
<p>When you install R, there is an option called <code class="docutils literal notranslate"><span class="pre">--with-recommended-packages</span></code>.
This flag causes the R installation to include a few “Recommended” packages
(legacy term). They are for historical reasons quite tied to the core R
distribution, developed by the R core team or people closely related to it.
The R core distribution “knows” about these package, but they are indeed
distributed via CRAN. Because they’re distributed via CRAN, they can also be
updated between R version releases.</p>
<p>Spack explicitly adds the <code class="docutils literal notranslate"><span class="pre">--without-recommended-packages</span></code> flag to prevent
the installation of these packages. Due to the way Spack handles package
activation (symlinking packages to the R installation directory),
pre-existing recommended packages will cause conflicts for already-existing
files. We could either not include these recommended packages in Spack and
require them to be installed through <code class="docutils literal notranslate"><span class="pre">--with-recommended-packages</span></code>, or
we could not install them with R and let users choose the version of the
package they want to install. We chose the latter.</p>
<p>Since these packages are so commonly distributed with the R system, many
developers may assume these packages exist and fail to list them as
dependencies. Watch out for this.</p>
<p>You can find a list of these recommended packages at:
<a class="reference external" href="https://github.com/wch/r-source/blob/trunk/share/make/vars.mk">https://github.com/wch/r-source/blob/trunk/share/make/vars.mk</a></p>
</section>
<section id="non-core-packages">
<h3>Non-core packages<a class="headerlink" href="#non-core-packages" title="Link to this heading"></a></h3>
<p>These are packages that are neither “core” nor “recommended”. There are more
than 10,000 of these packages hosted on CRAN alone.</p>
<p>For each of these package types, if you see that a specific version is
required, for example, “lattice (≥ 0.20)”, please add this information to
the dependency:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">depends_on</span><span class="p">(</span><span class="s2">&quot;r-lattice@0.20:&quot;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;build&quot;</span><span class="p">,</span> <span class="s2">&quot;run&quot;</span><span class="p">))</span>
</pre></div>
</div>
</section>
</section>
<section id="non-r-dependencies">
<h2>Non-R dependencies<a class="headerlink" href="#non-r-dependencies" title="Link to this heading"></a></h2>
<p>Some packages depend on non-R libraries for linking. Check out the
<a class="reference external" href="https://github.com/spack/spack/blob/develop/var/spack/repos/builtin/packages/r-stringi/package.py">r-stringi</a>
package for an example: <a class="reference external" href="https://cloud.r-project.org/package=stringi">https://cloud.r-project.org/package=stringi</a>.
If you search for the text “SystemRequirements”, you will see:</p>
<blockquote>
<div><p>ICU4C (&gt;= 52, optional)</p>
</div></blockquote>
<p>This is how non-R dependencies are listed. Make sure to add these
dependencies. The default dependency type should suffice.</p>
</section>
<section id="passing-arguments-to-the-installation">
<h2>Passing arguments to the installation<a class="headerlink" href="#passing-arguments-to-the-installation" title="Link to this heading"></a></h2>
<p>Some R packages provide additional flags that can be passed to
<code class="docutils literal notranslate"><span class="pre">R</span> <span class="pre">CMD</span> <span class="pre">INSTALL</span></code>, often to locate non-R dependencies.
<a class="reference external" href="https://github.com/spack/spack/blob/develop/var/spack/repos/builtin/packages/r-rmpi/package.py">r-rmpi</a>
is an example of this, and flags for linking to an MPI library. To pass
these to the installation command, you can override <code class="docutils literal notranslate"><span class="pre">configure_args</span></code>
like so:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">configure_args</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="n">mpi_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">spec</span><span class="p">[</span><span class="s2">&quot;mpi&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">name</span>

    <span class="c1"># The type of MPI. Supported values are:</span>
    <span class="c1"># OPENMPI, LAM, MPICH, MPICH2, or CRAY</span>
    <span class="k">if</span> <span class="n">mpi_name</span> <span class="o">==</span> <span class="s2">&quot;openmpi&quot;</span><span class="p">:</span>
        <span class="n">Rmpi_type</span> <span class="o">=</span> <span class="s2">&quot;OPENMPI&quot;</span>
    <span class="k">elif</span> <span class="n">mpi_name</span> <span class="o">==</span> <span class="s2">&quot;mpich&quot;</span><span class="p">:</span>
        <span class="n">Rmpi_type</span> <span class="o">=</span> <span class="s2">&quot;MPICH2&quot;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">InstallError</span><span class="p">(</span><span class="s2">&quot;Unsupported MPI type&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="p">[</span>
        <span class="s2">&quot;--with-Rmpi-type=</span><span class="si">{0}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">Rmpi_type</span><span class="p">),</span>
        <span class="s2">&quot;--with-mpi=</span><span class="si">{0}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">spec</span><span class="p">[</span><span class="s2">&quot;mpi&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">prefix</span><span class="p">),</span>
    <span class="p">]</span>
</pre></div>
</div>
<p>There is a similar <code class="docutils literal notranslate"><span class="pre">configure_vars</span></code> function that can be overridden
to pass variables to the build.</p>
</section>
<section id="alternatives-to-spack">
<h2>Alternatives to Spack<a class="headerlink" href="#alternatives-to-spack" title="Link to this heading"></a></h2>
<p>CRAN hosts over 10,000 R packages, most of which are not in Spack. Many
users may not need the advanced features of Spack, and may prefer to
install R packages the normal way:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>R
<span class="go">&gt; install.packages(&quot;ggplot2&quot;)</span>
</pre></div>
</div>
<p>R will search CRAN for the <code class="docutils literal notranslate"><span class="pre">ggplot2</span></code> package and install all necessary
dependencies for you. If you want to update all installed R packages to
the latest release, you can use:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">&gt; update.packages(ask = FALSE)</span>
</pre></div>
</div>
<p>This works great for users who have internet access, but those on an
air-gapped cluster will find it easier to let Spack build a download
mirror and install these packages for you.</p>
<p>Where Spack really shines is its ability to install non-R dependencies
and link to them properly, something the R installation mechanism
cannot handle.</p>
</section>
<section id="external-documentation">
<h2>External documentation<a class="headerlink" href="#external-documentation" title="Link to this heading"></a></h2>
<p>For more information on installing R packages, see:
<a class="reference external" href="https://stat.ethz.ch/R-manual/R-devel/library/utils/html/INSTALL.html">https://stat.ethz.ch/R-manual/R-devel/library/utils/html/INSTALL.html</a></p>
<p>For more information on writing R packages, see:
<a class="reference external" href="https://cloud.r-project.org/doc/manuals/r-release/R-exts.html">https://cloud.r-project.org/doc/manuals/r-release/R-exts.html</a></p>
<p>In particular,
<a class="reference external" href="https://cloud.r-project.org/doc/manuals/r-release/R-exts.html#Package-Dependencies">https://cloud.r-project.org/doc/manuals/r-release/R-exts.html#Package-Dependencies</a>
has a great explanation of the difference between Depends, Imports,
and LinkingTo.</p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="pythonpackage.html" class="btn btn-neutral float-left" title="Python" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="racketpackage.html" class="btn btn-neutral float-right" title="Racket" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2013-2023, Lawrence Livermore National Laboratory..
      <span class="lastupdated">Last updated on Sep 20, 2025.
      </span></p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>